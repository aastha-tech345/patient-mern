"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2214],{72214:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var a=s(65043),l=s(63043),n=s(77154),i=s(6145),o=s(96026),c=s(91036),r=s(84086),d=s(70579);const m=e=>{let{diagnosis:t}=e;const[s,l]=(0,a.useState)([]),[m,h]=(0,a.useState)(!1),[p,u]=(0,a.useState)({});(0,a.useEffect)((()=>{if(t&&Array.isArray(t)){const e=[...t].reverse();l(e)}}),[t]);const[x,j]=(0,a.useState)(null);return(0,d.jsxs)("div",{style:{maxHeight:"300px",marginTop:"20px"},children:[null===s||void 0===s?void 0:s.map(((e,t)=>{var s;const a=new Date(e.date).toLocaleDateString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,d.jsxs)("div",{style:{margin:"1rem"},children:[(0,d.jsx)("div",{className:"row",style:{overflowX:"auto"},children:(0,d.jsxs)("div",{style:{overflow:"auto !important"},children:[(0,d.jsxs)("h5",{children:["Diagnose Date: ",a]}),(0,d.jsxs)("table",{className:"table",style:{width:"100%",border:"1px solid",fontFamily:"ui-rounded",borderRadius:"10px"},children:[(0,d.jsxs)("colgroup",{children:[(0,d.jsx)("col",{style:{width:"20%"}}),(0,d.jsx)("col",{style:{width:"20%"}}),(0,d.jsx)("col",{style:{width:"30%"}}),(0,d.jsx)("col",{style:{width:"30%"}})]}),(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Problems"}),(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Sub Problem"}),(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Tests"}),(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Scales"})]})}),null===e||void 0===e||null===(s=e.diagnosData)||void 0===s?void 0:s.map(((e,t)=>{const{problem:s,subProblem:a,scale:l,test:c}=e;return console.log("hgsad",e),(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("tbody",{children:[m&&(0,d.jsx)(r.A,{message:"Opening File"}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{style:{fontWeight:"bolder"},children:s}),(0,d.jsx)("td",{style:{fontWeight:"bolder"},children:a||"-"}),(0,d.jsx)("td",{children:c.map(((e,t)=>{var s;return(0,d.jsx)("div",{children:""===e.name?"-":(0,d.jsxs)("div",{className:"row",style:{margin:0},children:[(0,d.jsx)("td",{style:{width:"50%",paddingRight:"10px",margin:"auto",fontWeight:"bolder"},children:e.name}),(0,d.jsx)("div",{style:{width:"50%"},children:(0,d.jsx)("td",{style:{margin:"0",padding:0},children:""!==e.testInput?(0,d.jsx)("td",{style:{width:"40%",paddingRight:"10px",margin:"auto"},children:e.testInput}):(0,d.jsx)("div",{style:{display:"flex",margin:0},children:null===(s=e.files)||void 0===s?void 0:s.map(((e,t)=>(0,d.jsx)("div",{value:e.fileName,style:{display:"flex",alignItems:"center",marginRight:"10px",margin:"0 5px 0 0"},onMouseEnter:()=>{const t=(e=>{if(e){const t=e,s=t.split("_");return s.length>1?s.slice(1).join("_").split(".")[0]:t}return""})(e.fileName);j(t)},onMouseLeave:()=>j(""),onClick:()=>(async(e,t)=>{try{h(!0);const t=await n.A.get("".concat("http://18.204.141.1:8090","/api/user/getPatientReport/").concat(e),{responseType:"blob"}),s=new Blob([t.data],{type:t.headers["content-type"]}),a=URL.createObjectURL(s);window.open(a)}catch(s){h(!1),console.error("Error fetching report:",s)}finally{h(!1)}})(null===e||void 0===e?void 0:e.fileName),children:(0,d.jsx)("button",{type:"button",className:"btn btn-sm btn-primary","data-toggle":"popover",title:x,style:{margin:"0"},children:(0,d.jsx)(i.A,{icon:o.I})})},t)))})})})]})},t)}))}),(0,d.jsx)("td",{children:l.map(((e,t)=>(0,d.jsx)("div",{children:""===e.name?"-":(0,d.jsxs)("div",{className:"row",style:{margin:0},children:[(0,d.jsx)("div",{className:"col-md-6",style:{fontWeight:"bolder",paddingRight:"10px",margin:"auto",wordWrap:"break-word"},children:e.name}),(0,d.jsx)("div",{className:"col-md-6 tableTitle",style:{margin:"0",padding:0,wordWrap:"break-word"},children:e.value})]})},t)))})]})]},t)})})),0!==(null===e||void 0===e?void 0:e.procedure.length)?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:"4",children:(0,d.jsx)("h5",{style:{fontWeight:"bolder"},children:"Procedures:"})})}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Name"}),(0,d.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Complications"}),(0,d.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Done By"}),(0,d.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Date"})]}),null===e||void 0===e?void 0:e.procedure.map(((e,t)=>{const s=new Date(e.date).toLocaleDateString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{children:["\xa0\xa0",e.name]}),(0,d.jsx)("td",{children:e.complications}),(0,d.jsx)("td",{children:e.doneBy}),(0,d.jsx)("td",{children:s})]},t)}))]}):""]}),(0,d.jsx)("div",{className:"row",style:{margin:"1rem auto 1rem 0"},children:(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{className:"card",style:{padding:"1rem 2rem"},children:(0,d.jsx)("div",{className:"d-flex",children:(0,d.jsxs)("p",{style:{margin:"0"},children:[" ","Notes :\xa0\xa0\xa0",""===e.desc?"-":e.desc]})})})})})})]})}),(0,d.jsx)("hr",{style:{width:"100%"}})]},t)})),(0,d.jsx)(c.N9,{})]})};var h=s(14182),p=s(66921),u=s(58390),x=s(80365),j=(s(92342),s(88625)),v=s(69833),g=s(56063),f=s(60446),b=s.n(f);const y=e=>{var t;let{_id:s,getSearchByPatient:n,setIsAddNewDiagnosis:o,setIsDetailed:m,diagnosisProp:f}=e,y="http://18.204.141.1:8090",N=localStorage.getItem("patientRecord"),w=JSON.parse(N);const D=new Date,[S,C]=(0,a.useState)([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),[P,A]=(0,a.useState)([{name:"",complications:"",doneBy:"",date:b()(D)}]),[k,R]=(0,a.useState)(""),[F,I]=(0,a.useState)(!1);let[E,T]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=f[f.length-1],t=null===e||void 0===e?void 0:e.diagnosData[(null===e||void 0===e?void 0:e.diagnosData.length)-1];R(t),console.log("Guarssadva",t),C([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}])}),[]);const[B,_]=a.useState(null),[L,M]=(0,a.useState)({}),[W,z]=(0,a.useState)(""),[V,H]=(0,a.useState)({diagnosis:[],desc:""}),[O,U]=(0,a.useState)([]);let[Y,Z]=(0,a.useState)(!1);const[J,K]=(0,a.useState)([]),[$,q]=(0,a.useState)([]),[G,X]=(0,a.useState)([]),[Q,ee]=(0,a.useState)(!1);(0,a.useEffect)((()=>{te()}),[]);const te=async()=>{try{var e,t;const s=await(0,l.J4)("".concat(y,"/api/problem/").concat(null===w||void 0===w||null===(e=w.department_id)||void 0===e?void 0:e._id)),a=null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.data[0];if(a){const e=a.problemName.filter((e=>"problem"===e.type)).map((e=>e.name)),t=a.problemName.filter((e=>"scale"===e.type)).map((e=>e.name)),s=a.problemName.filter((e=>"test"===e.type)).map((e=>{let{name:t,inputType:s}=e;return{name:t,inputType:s}}));q(s),X(t),K(e)}}catch(s){console.error("Error fetching problems:",s)}};(0,a.useEffect)((()=>{L.desc&&H((e=>({...e,desc:L.desc})))}),[L]),(0,a.useEffect)((()=>{(async()=>{try{const e=await(0,l.J4)("".concat(y,"/api/patient/").concat(s));M(e.data.data)}catch(e){console.log(e)}})()}),[]);let[se,ae]=(0,a.useState)(!1);const le=(e,t)=>{const{name:s,value:a}=t.target,l=[...S];l[e][s]=a,C(l)},ne=()=>{S.every((e=>""!==e.problem))?C([...S,{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]):c.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},ie=e=>{const t=[...S];t.splice(e,1),C(t)};(0,a.useEffect)((()=>{S.length>1?ae(!0):ae(!1)}),[ie,ne,le]);const oe=(e,t,s)=>{const{name:a,value:l}=s.target,n=[...S];n[e].scale[t][a]=l,C(n)},ce=(e,t)=>{const{name:s,value:a}=t.target,l=[...P];l[e][s]=a,A(l)},re=()=>{P.every((e=>""!==e.name))?A([...P,{name:"",complications:"",doneBy:"",date:b()(D)}]):c.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})};return(0,a.useEffect)((()=>{S.length>1?ae(!0):ae(!1),P.length>1?T(!0):T(!1)}),[ie,ne,le,re,ce]),(0,a.useEffect)((()=>{console.log("Inputs ",S)})),(0,d.jsxs)(d.Fragment,{children:[Y&&(0,d.jsx)(r.A,{loading:Y,message:"Uploading Files"}),Q&&(0,d.jsx)(r.A,{message:"Adding Diagnosis"}),(0,d.jsxs)("div",{style:{margin:"1rem auto 1rem 1rem"},children:[(0,d.jsx)("div",{className:"addPatientDataInnerDiv",children:(0,d.jsxs)("h4",{children:["Diagnosis: (",null===w||void 0===w||null===(t=w.department_id)||void 0===t?void 0:t.departmentName,")"]})}),(0,d.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),1===S.length&&""===S[0].problem)return c.oR.warning("Please select at least one Chief complaint");const t=S.map((e=>({...e,test:e.test.filter((e=>""!==e.name)),scale:e.scale.filter((e=>""!==e.name))}))).filter((e=>""!==e.problem)),a=P.filter((e=>""!==e.name));for(const s of t){if(s.test.length>0&&s.test.some((e=>""===e.testInput&&0===e.files.length)))return void c.oR.warning("Please provide input or upload file(s) for selected test(s)");if(s.scale.length>0&&s.scale.some((e=>""===e.value)))return void c.oR.warning("Please provide input for selected scale(s)")}Z(!0);try{await Promise.all(t.map((async(e,s)=>{await Promise.all(e.test.map((async(e,a)=>{if(e.files){const n=e.files;if(n.length>0){const e=new FormData;if(n.forEach((t=>{["image/jpeg","image/png","application/pdf"].includes(t.type)?e.append("files",t):console.warn("File type not allowed:",t.type)})),e.has("files")){const n=await(0,l.De)("".concat(y,"/api/user/uploadPatientReport"),e);n&&(Z(!1),t[s].test[a].files=n.filesInfo)}else Z(!1),console.warn("No valid files to upload")}}else t[s].test[a].files=null,Z(!1)})))})))}catch(i){return Z(!1),void console.error("Error uploading files:",i)}try{ee(!0);const e={...V,diagnosis:[{diagnosData:t,procedure:a,date:Date(),desc:W}],nextApointmentDate:B};await(0,l.E8)("".concat(y,"/api/patient/update/").concat(s),e)&&(U([]),z(""),c.oR.success("Patient Updated Successfully",{autoClose:1e3}),o(!1),m(!0),C([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),ee(!1),n())}catch(i){console.log(i)}},children:[(0,d.jsxs)("form",{className:"mb-3",children:[S.map(((e,t)=>(0,d.jsxs)("div",{className:"row mt-1 mb-2",children:[(0,d.jsxs)("div",{className:"col-md-2 col-12",children:[(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"problem",value:e.problem,onChange:e=>le(t,e),children:[(0,d.jsx)("option",{value:"",children:"Chief complaint"}),J.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})}),(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",type:"text",placeholder:"Enter sub problem",name:"subProblem",onChange:e=>le(t,e)})})]}),(0,d.jsx)("div",{className:"col-md-4 col-12",children:e.test.map(((s,a)=>(0,d.jsxs)("div",{className:"d-flex mb-1",children:[(0,d.jsx)("div",{style:{width:"40%"},children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:s.name,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...S];n[e].test[t][a]=l,C(n)})(t,a,e),children:[(0,d.jsx)("option",{value:"",children:"Select Test"}),$.map(((e,t)=>(0,d.jsx)("option",{value:e.name,children:e.name},t)))]})})}),""===s.name?(0,d.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Select a Test",type:"text",disabled:"true"})})}):(0,d.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:$.map((s=>{if(s.name===e.test[a].name){if("text"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},placeholder:"Enter test Value",type:"text",name:"testInput",value:e.test[a].text,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...S];n[e].test[t][a]=l,C(n)})(t,a,e)})},a);if("file"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},type:"file",multiple:!0,name:"files",accept:"image/jpeg, image/png, application/pdf",onChange:e=>((e,t,s)=>{const{name:a,files:l}=s.target,n=["image/jpeg","image/png","application/pdf"];if(l.length>3)return s.target.value="",void c.oR.warning("You can only upload up to 3 files",{autoClose:1500});const i=[...S],o=Array.from(l).filter((e=>e.size>31457280?(c.oR.warning("File size should be less than 30 MB",{autoClose:1500}),!1):!!n.includes(e.type)||(c.oR.warning("Only images and PDFs are allowed",{autoClose:1500}),!1)));i[e].test[t].files=o,C(i)})(t,a,e)})},a)}return null}))}),(0,d.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.test.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...S];a[t].test.splice(s,1),C(a)})(e,t,a),children:(0,d.jsx)(i.A,{icon:j.V})}),a===e.test.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),S[t].test[S[t].test.length-1].name){const e=[...S];e[t].test.push({name:"",testInput:"",files:[]}),C(e)}else c.oR.warning("Please Enter Previous test field before adding new")})(e,t),children:(0,d.jsx)(i.A,{icon:v.x})})]})]},s)))}),(0,d.jsx)("div",{className:"col-md-4 col-12 ",children:e.scale.map(((s,a)=>(0,d.jsxs)("div",{className:"d-flex mb-1",children:[(0,d.jsx)("div",{style:{width:"40%"},children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:e.scale[a].name,onChange:e=>oe(t,a,e),children:[(0,d.jsx)("option",{value:"",children:"Select Scale"}),G.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})})}),(0,d.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Enter Scale Value",type:"text",name:"value",value:e.scale[a].value,onChange:e=>oe(t,a,e)})})}),(0,d.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.scale.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...S];a[t].scale.splice(s,1),C(a)})(e,t,a),children:(0,d.jsx)(i.A,{icon:j.V})}),a===e.scale.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),S[t].scale[S[t].scale.length-1].name){const e=[...S];e[t].scale.push({name:"",value:""}),C(e)}else c.oR.warning("Please Enter Previous Scale field before adding new")})(e,t),children:(0,d.jsx)(i.A,{icon:v.x})})]})]},a)))}),(0,d.jsx)("div",{className:"col-md-2 d-flex justify-content-end col-12",children:se&&(0,d.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>ie(t),children:(0,d.jsx)(i.A,{icon:g.Z,size:"xl"})})})]},t))),(0,d.jsx)("div",{className:"d-flex justify-content-end",children:(0,d.jsx)("button",{className:"btn btn-primary me-4",type:"button",onClick:ne,children:"Add More"})})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("input",{type:"checkbox",checked:F,onChange:()=>I(!F)}),(0,d.jsx)("label",{children:" \xa0\xa0\xa0Add Procedure"})]}),F?(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("form",{children:[P.map(((e,t)=>(0,d.jsx)("div",{children:(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-md-2 col-sm-10 ",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{onChange:e=>ce(t,e),value:e.name,name:"name",className:"form-control addPatientDataInputDiv",placeholder:"Procedure Name",type:"text"})})}),(0,d.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{onChange:e=>ce(t,e),value:e.complications,name:"complications",className:"form-control addPatientDataInputDiv",placeholder:"Complications",type:"text"})})}),(0,d.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{onChange:e=>ce(t,e),value:e.doneBy,name:"doneBy",className:"form-control addPatientDataInputDiv",placeholder:"Done By",type:"text"})})}),(0,d.jsx)("div",{className:"col-md-4 col-sm-10",children:(0,d.jsx)("div",{className:"d-flex",children:(0,d.jsx)("div",{className:"w-auto",children:(0,d.jsx)(u.$,{dateAdapter:p.R,children:(0,d.jsx)(h.j,{components:["DateTimePicker"],children:(0,d.jsx)(x.K,{label:"To",value:e.date,inputFormat:"YYYY-MM-DD",ampm:!1,ampmInClock:!1,views:["year","month","day"],slotProps:{textField:{size:"small"}}})})})})})}),(0,d.jsx)("div",{className:"col-md-2 d-flex ",children:E&&(0,d.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>(e=>{const t=[...P];t.splice(e,1),A(t)})(t),children:(0,d.jsx)(i.A,{icon:g.Z,size:"xl"})})})]})})},t))),(0,d.jsx)("div",{className:"d-flex justify-content-end",children:(0,d.jsx)("button",{className:"btn btn-primary me-4",type:"button",onClick:()=>re(),children:"Add More"})})]})}):""]}),(0,d.jsx)("div",{children:(0,d.jsx)("textarea",{rows:4,className:"form-control col-12",placeholder:"Notes (Optional)",name:"desc",value:W,onChange:e=>z(e.target.value)})}),(0,d.jsx)("div",{className:"d-flex mt-2",children:(0,d.jsx)("div",{className:"w-auto",children:(0,d.jsx)(u.$,{dateAdapter:p.R,children:(0,d.jsx)(h.j,{components:["DateTimePicker"],children:(0,d.jsx)(x.K,{label:"Next Appointment Date",value:B,onChange:e=>{_(e)}})})})})}),(0,d.jsxs)("div",{className:"text-end",children:[(0,d.jsx)("button",{type:"submit",className:"btn btn-primary mt-4",style:{width:"10rem"},children:"Submit"}),(0,d.jsx)("button",{type:"submit",className:"btn btn-danger mt-4 ms-2",style:{width:"10rem"},onClick:()=>(o(!1),void m(!0)),children:"Close"})]})]}),(0,d.jsx)(c.N9,{})]})]})},N=e=>{let{patientSearch:t,getSearchByPatient:s}=e;const[l,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[c,r]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),u=e=>{r((t=>t===e?"":e)),p(""),o(!0)},x=e=>{p(e),r(e),n(!0),o(!1)},[j,v]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{function e(){v(window.innerWidth<=768)}return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,d.jsx)("div",{children:j?(0,d.jsx)(d.Fragment,{children:null===t||void 0===t?void 0:t.map((e=>{const{name:t,crn:a,phone:r,age:p,sex:j,diagnosis:v,_id:g,desc:f,nextApointmentDate:b}=e,N=c===g,w=h===g,D=v,S=new Date(b).toLocaleString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,d.jsx)("div",{children:(0,d.jsx)("div",{style:{marginTop:"2rem"},children:(0,d.jsx)("div",{className:"card",style:{width:"100%"},children:(0,d.jsxs)("div",{className:"card-body overflow-auto ",children:[(0,d.jsxs)("div",{className:"row",style:{marginBottom:"1rem"},children:[(0,d.jsxs)("div",{style:{width:"40%"},children:[(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"CR No :"})," ",a]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Age : "})," ",p]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Sex. "})," ",j]})]}),(0,d.jsxs)("div",{style:{width:"60%"},children:[(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Name : "})," ",t]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Mob. No."})," ",r]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Next Appointment Date."})," ",b?S:"-"]})]})]}),(0,d.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,d.jsx)("button",{type:"button",className:"btn btn-success patientInfoButton",onClick:()=>u(g),children:"Show Diagnosis"}),(0,d.jsx)("button",{type:"button",className:"btn btn-warning",style:{marginLeft:"2rem"},onClick:()=>x(g),children:v?"Add New Follow-Up":"Add New Diagnosis"})]}),N&&i&&(0,d.jsx)("div",{children:(0,d.jsx)(m,{diagnosis:v,desc:f})}),w&&l&&(0,d.jsx)("div",{children:(0,d.jsx)(y,{_id:g,getSearchByPatient:s,setIsAddNewDiagnosis:n,setIsDetailed:o,diagnosisProp:D})})]})})})},g)}))}):(0,d.jsx)("div",{className:"mb-4",children:null===t||void 0===t?void 0:t.map((e=>{const{name:t,crn:a,phone:r,age:p,sex:j,diagnosis:v,_id:g,desc:f,nextApointmentDate:b}=e,N=c===g,w=h===g,D=v,S=new Date(b).toLocaleString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{style:{marginTop:"2rem"},children:(0,d.jsx)("div",{className:"card",style:{width:"100%"},children:(0,d.jsxs)("div",{className:"card-body overflow-auto ",children:[(0,d.jsxs)("h5",{className:"card-title",children:[" CR No : ",a]}),(0,d.jsx)("h6",{className:"card-subtitle mt-2",children:(0,d.jsxs)("h5",{children:["Name : ",t]})}),(0,d.jsxs)("div",{style:{display:"flex",marginTop:"1rem"},children:[(0,d.jsxs)("span",{style:{display:"flex"},children:[(0,d.jsx)("h6",{children:"Phone No. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:r})]}),(0,d.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,d.jsx)("h6",{children:"Age. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:p})]}),(0,d.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,d.jsx)("h6",{children:" Sex. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:j})]}),(0,d.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,d.jsx)("h6",{children:"Next Appointment Date. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:b?S:"-"})]})]}),(0,d.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,d.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>u(g),style:{fontSize:"15px",whiteSpace:"none",padding:"5px 10px"},children:"Show Diagnosis"}),(0,d.jsx)("button",{type:"button",className:"btn btn-warning",style:{marginLeft:"2rem"},onClick:()=>x(g),children:v?"Add New Follow-Up":"Add New Diagnosis"})]}),N&&i&&(0,d.jsx)("div",{children:(0,d.jsx)(m,{diagnosis:v,desc:f})}),w&&l&&(0,d.jsxs)("div",{children:[(0,d.jsx)(y,{_id:g,getSearchByPatient:s,setIsAddNewDiagnosis:n,setIsDetailed:o,diagnosisProp:D}),(0,d.jsx)(m,{diagnosis:v,desc:f})]})]})})})},g)}))})})};var w=s(63483),D=s(81637),S=s(96446);const C=()=>(0,d.jsx)(S.A,{style:{width:"100%",height:"100%",lineHeight:"20vh",textAlign:"center",marginTop:"10px"},children:(0,d.jsx)(D.A,{})});var P=s(73216);s(83910);const A=e=>{var t;let{setData:s,setUpdatedSearch:n,getSearchByPatient:o,updatedSearch:m}=e;(0,P.zy)();const f=new Date;let y="http://18.204.141.1:8090",N=localStorage.getItem("patientRecord"),w=JSON.parse(N);const[D,S]=(0,a.useState)(!1),[C,A]=(0,a.useState)(!1),[k,R]=(0,a.useState)(!1),[F,I]=a.useState(null),[E,T]=(0,a.useState)([]),[B,_]=(0,a.useState)([]),[L,M]=(0,a.useState)([]),[W,z]=(0,a.useState)(""),V=Math.floor(9e3*Math.random())+1e3;let[H,O]=(0,a.useState)(!1);const[U,Y]=(0,a.useState)(!1),[Z,J]=(0,a.useState)(""),[K,$]=(0,a.useState)({name:"",age:"",sex:"male",phone:"",crn:"".concat(V),diagnosis:[],desc:"",doctor_id:null===w||void 0===w?void 0:w._id}),[q,G]=(0,a.useState)([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),[X,Q]=(0,a.useState)([{name:"",complications:"",doneBy:"",date:b()(f)}]);(0,a.useEffect)((()=>{ee()}),[]);const ee=async()=>{try{var e,t;const s=await(0,l.J4)("".concat(y,"/api/problem/").concat(null===w||void 0===w||null===(e=w.department_id)||void 0===e?void 0:e._id)),a=null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.data[0];if(a){const e=a.problemName.filter((e=>"problem"===e.type)).map((e=>e.name)),t=a.problemName.filter((e=>"scale"===e.type)).map((e=>e.name)),s=a.problemName.filter((e=>"test"===e.type)).map((e=>{let{name:t,inputType:s}=e;return{name:t,inputType:s}}));_(s),M(t),T(e)}}catch(s){console.error("Error fetching problems:",s)}};let[te,se]=(0,a.useState)(!1),[ae,le]=(0,a.useState)(!1);const ne=(e,t)=>{const{name:s,value:a}=t.target,l=[...q];l[e][s]=a,G(l)},ie=(e,t)=>{const{name:s,value:a}=t.target,l=[...X];l[e][s]=a,Q(l)},oe=()=>{q.every((e=>""!==e.problem))?G([...q,{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]):c.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},ce=()=>{X.every((e=>""!==e.name))?Q([...X,{name:"",complications:"",doneBy:"",date:b()(f)}]):c.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},re=e=>{const t=[...q];t.splice(e,1),G(t)};(0,a.useEffect)((()=>{q.length>1?se(!0):se(!1),X.length>1?le(!0):le(!1)}),[re,oe,ne,ce,ce,ie]),(0,a.useEffect)((()=>{console.log("Updated inputs:",q,X)}),[q]);const de=(e,t,s)=>{const{name:a,value:l}=s.target,n=[...q];n[e].scale[t][a]=l,G(n)};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{children:[H&&(0,d.jsx)(r.A,{loading:H}),(0,d.jsx)("div",{className:"content-to-be-blurred",children:(0,d.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("hr",{}),(0,d.jsx)("h4",{children:"Patient Details"}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-md-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Name ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsx)("input",{type:"text",className:"form-control ",name:"name",value:K.name,onChange:e=>$({...K,name:e.target.value})})})]})}),(0,d.jsx)("div",{className:"col-md-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Age ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsx)("input",{type:"number",className:"form-control ",name:"age",value:K.age,onChange:e=>$({...K,age:e.target.value})})})]})}),(0,d.jsx)("div",{className:"col-md-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Sex ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsxs)("select",{className:"form-control ",name:"sex",value:K.sex,onChange:e=>$({...K,sex:e.target.value}),children:[(0,d.jsx)("option",{value:"male",children:"Male"}),(0,d.jsx)("option",{value:"female",children:"Female"}),(0,d.jsx)("option",{value:"other",children:"Other"})]})})]})})]}),(0,d.jsxs)("div",{className:"row ",children:[(0,d.jsx)("div",{className:"col-md-4 mt-2",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-lg-4 patientNamediv",children:["Contact ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:" col-lg-8 col-sm-8",children:(0,d.jsx)("input",{className:"form-control ",type:"text",name:"phone",value:K.phone,onChange:e=>{(/^\d*$/.test(e.target.value)||""===e.target.value)&&$({...K,phone:e.target.value})},required:!0})})]})}),(0,d.jsx)("div",{className:"col-md-4 mt-2",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4  patientNamediv",children:["CR No ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsx)("input",{className:"form-control ",type:"test",name:"crn",value:K.crn,onChange:e=>$({...K,crn:e.target.value}),required:!0})})]})})]})]}),(0,d.jsx)("hr",{}),(0,d.jsx)("div",{className:"addPatientDataInnerDiv",children:(0,d.jsxs)("h4",{children:["Diagnosis: (",null===w||void 0===w||null===(t=w.department_id)||void 0===t?void 0:t.departmentName,")"]})}),(0,d.jsx)("div",{children:(0,d.jsxs)("form",{className:"mb-3",children:[q.map(((e,t)=>(0,d.jsxs)("div",{className:"row mt-1 mb-2",children:[(0,d.jsxs)("div",{className:"col-md-2 col-12",children:[(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv mb-1",name:"problem",value:e.problem,onChange:e=>ne(t,e),children:[(0,d.jsx)("option",{value:"",children:"Chief complaint"}),E.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})}),(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",type:"text",placeholder:"Enter sub problem",name:"subProblem",onChange:e=>ne(t,e)})})]}),(0,d.jsx)("div",{className:"col-md-4 col-12",children:e.test.map(((s,a)=>(0,d.jsxs)("div",{className:"d-flex mb-1",children:[(0,d.jsx)("div",{style:{width:"40%"},children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:s.name,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...q];n[e].test[t][a]=l,G(n)})(t,a,e),children:[(0,d.jsx)("option",{value:"",children:"Select Test"}),B.map(((e,t)=>(0,d.jsx)("option",{value:e.name,children:e.name},t)))]})})}),""===s.name?(0,d.jsx)("div",{style:{width:"40%",marginLeft:"4px"},children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Select a Test",type:"text",disabled:"true"})})}):(0,d.jsx)("div",{style:{width:"40%",marginLeft:"4px"},children:B.map((s=>{if(s.name===e.test[a].name){if("text"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},placeholder:"Enter test Value",type:"text",name:"testInput",value:e.test[a].text,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...q];n[e].test[t][a]=l,console.log("guarav",n)})(t,a,e)})},a);if("file"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},type:"file",multiple:!0,name:"files",accept:"image/jpeg, image/png, application/pdf",onChange:e=>((e,t,s)=>{const{name:a,files:l}=s.target,n=["image/jpeg","image/png","application/pdf"];if(l.length>3)return s.target.value="",void c.oR.warning("You can only upload up to 3 files",{autoClose:1500});const i=[...q],o=Array.from(l).filter((e=>e.size>31457280?(c.oR.warning("File size should be less than 30 MB",{autoClose:1500}),!1):!!n.includes(e.type)||(c.oR.warning("Only images and PDFs are allowed",{autoClose:1500}),!1)));i[e].test[t].files=o,G(i)})(t,a,e)})},a)}return null}))}),(0,d.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.test.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...q];a[t].test.splice(s,1),G(a)})(e,t,a),children:(0,d.jsx)(i.A,{icon:j.V})}),a===e.test.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),q[t].test[q[t].test.length-1].name){const e=[...q];e[t].test.push({name:"",testInput:"",files:[]}),G(e)}else c.oR.warning("Please Enter Previous test field before adding new")})(e,t),children:(0,d.jsx)(i.A,{icon:v.x})})]})]},s)))}),(0,d.jsx)("div",{className:"col-md-4 col-12 ",children:e.scale.map(((s,a)=>(0,d.jsxs)("div",{className:"d-flex mb-1",children:[(0,d.jsx)("div",{style:{width:"40%"},children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:e.scale[a].name,onChange:e=>de(t,a,e),children:[(0,d.jsx)("option",{value:"",children:"Select Scale"}),L.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})})}),(0,d.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Enter Scale Value",type:"text",name:"value",value:e.scale[a].value,onChange:e=>de(t,a,e)})})}),(0,d.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.scale.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...q];a[t].scale.splice(s,1),G(a)})(e,t,a),children:(0,d.jsx)(i.A,{icon:j.V})}),a===e.scale.length-1&&(0,d.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),q[t].scale[q[t].scale.length-1].name){const e=[...q];e[t].scale.push({name:"",value:""}),G(e)}else c.oR.warning("Please Enter Previous Scale field before adding new")})(e,t),children:(0,d.jsx)(i.A,{icon:v.x})})]})]},a)))}),(0,d.jsx)("div",{className:"col-md-2 d-flex justify-content-end col-12",children:te&&(0,d.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>re(t),children:(0,d.jsx)(i.A,{icon:g.Z,size:"xl"})})})]},t))),(0,d.jsx)("div",{className:"d-flex justify-content-end",children:(0,d.jsx)("button",{className:"btn btn-outline-primary me-4",type:"button",onClick:oe,children:"Add More"})})]})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("input",{type:"checkbox",checked:U,onChange:()=>Y(!U)}),(0,d.jsx)("label",{children:" \xa0\xa0\xa0Add Procedure"})]}),U?(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("form",{children:[X.map(((e,t)=>(0,d.jsx)("div",{children:(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-md-2 col-sm-10 ",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{onChange:e=>ie(t,e),value:e.name,name:"name",className:"form-control addPatientDataInputDiv",placeholder:"Procedure Name",type:"text"})})}),(0,d.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{onChange:e=>ie(t,e),value:e.complications,name:"complications",className:"form-control addPatientDataInputDiv",placeholder:"Complications",type:"text"})})}),(0,d.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{onChange:e=>ie(t,e),value:e.doneBy,name:"doneBy",className:"form-control addPatientDataInputDiv",placeholder:"Done By",type:"text"})})}),(0,d.jsx)("div",{className:"col-md-4 col-sm-10",children:(0,d.jsx)("div",{className:"d-flex",children:(0,d.jsx)("div",{className:"w-auto",children:(0,d.jsx)(u.$,{dateAdapter:p.R,children:(0,d.jsx)(h.j,{components:["DateTimePicker"],children:(0,d.jsx)(x.K,{label:"To",value:e.date,inputFormat:"YYYY-MM-DD",ampm:!1,ampmInClock:!1,views:["year","month","day"],slotProps:{textField:{size:"small"}}})})})})})}),(0,d.jsx)("div",{className:"col-md-2 d-flex ",children:ae&&(0,d.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>(e=>{const t=[...X];t.splice(e,1),Q(t)})(t),children:(0,d.jsx)(i.A,{icon:g.Z,size:"xl"})})})]})})},t))),(0,d.jsx)("div",{className:"d-flex justify-content-end",children:(0,d.jsx)("button",{className:"btn btn-outline-primary me-4",type:"button",onClick:ce,children:"Add More"})})]})}):""]}),(0,d.jsx)("div",{children:(0,d.jsx)("textarea",{rows:4,className:"form-control col-12",placeholder:"Notes (Optional)",name:"desc",value:Z,onChange:e=>J(e.target.value)})})]}),(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"d-flex mt-2",children:(0,d.jsx)("div",{className:"w-auto",children:(0,d.jsx)(u.$,{dateAdapter:p.R,children:(0,d.jsx)(h.j,{components:["DateTimePicker"],children:(0,d.jsx)(x.K,{label:"Next Appointment Date",value:F,onChange:e=>{I(e)}})})})})})}),(0,d.jsxs)("div",{className:"text-end m-4",children:[(0,d.jsx)("button",{className:"btn btn-info mt-3 mx-2 w-auto",onClick:async()=>{if(!K.name||!K.age||!K.sex||!K.phone||!K.crn)return c.oR.warning("Please fill all Patient details");if(1===q.length&&""===q[0].problem)return c.oR.warning("Please select at least one Chief complaint");const e=q.map((e=>({...e,test:e.test.filter((e=>""!==e.name)),scale:e.scale.filter((e=>""!==e.name))}))).filter((e=>""!==e.problem)),t=X.filter((e=>""!==e.name));for(const s of e){if(s.test.length>0&&s.test.some((e=>""===e.testInput&&0===e.files.length)))return void c.oR.warning("Please provide input or upload file(s) for selected test(s)");if(s.scale.length>0&&s.scale.some((e=>""===e.value)))return void c.oR.warning("Please provide input for selected scale(s)")}O(!0);try{await Promise.all(e.map((async(t,s)=>{await Promise.all(t.test.map((async(t,a)=>{if(t.files){const n=t.files;if(n.length>0){const t=new FormData;if(n.forEach((e=>{["image/jpeg","image/png","application/pdf"].includes(e.type)?t.append("files",e):console.warn("File type not allowed:",e.type)})),t.has("files")){const n=await(0,l.De)("".concat(y,"/api/user/uploadPatientReport"),t);n&&(O(!1),e[s].test[a].files=n.filesInfo)}else O(!1),console.warn("No valid files to upload")}}else e[s].test[a].files=null,O(!1)})))})))}catch(r){return O(!1),void console.error("Error uploading files:",r)}const a={...K,diagnosis:[{diagnosData:e,procedure:t,date:Date(),desc:Z}],nextApointmentDate:F};console.log("final input",a);try{var i,o;const e=await localStorage.getItem("patientRecord"),t=null===(i=JSON.parse(e))||void 0===i?void 0:i._id,r=await(0,l.Hl)("".concat(y,"/api/patient/create/").concat(t),a);!0===r.success&&(c.oR.success("Patient Created Successfully",{autoClose:2e3}),O(!1),R(!0),s(!1),S(!0),R(!1),J(""),I(null),G([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),Q({name:"",complications:"",doneBy:"",date:b()(f)}),$({name:"",age:"",sex:"male",phone:"",crn:"".concat(V),diagnosis:[],desc:"",doctor_id:null===w||void 0===w?void 0:w._id})),"phone Already Exists"===r.message&&(c.oR.warning("phone Already Exists"),O(!1)),"Crn Already Exists"===r.message&&(c.oR.warning("Crn Already Exists"),O(!1)),n(null===r||void 0===r||null===(o=r.data)||void 0===o?void 0:o.crn)}catch(r){c.oR.warning("Something went wrong"),O(!1),console.error("Error submitting data:",r)}},children:"Submit"}),(0,d.jsx)("button",{className:"btn btn-info mt-3 w-auto",onClick:()=>{s(!1),G([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),$({name:"",age:"",sex:"male",phone:"",crn:"".concat(V),diagnosis:[],desc:"",doctor_id:null===w||void 0===w?void 0:w._id})},children:"Close"})]})]})})]}),(0,d.jsx)(c.N9,{})]})},k=()=>{const e=(0,P.zy)();let t=localStorage.getItem("patientRecord");JSON.parse(t);const[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[r,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[u,x]=(0,a.useState)(""),[j,v]=(0,a.useState)([]),[g,f]=(0,a.useState)(""),[b,y]=(0,a.useState)("");(0,a.useEffect)((()=>{x("");const t=new URLSearchParams(e.search).get("crn");t&&f(t)}),[]),(0,a.useEffect)((()=>{""!==g&&S()}),[g]);const D=()=>{try{x(""),v([])}catch(e){console.log(e)}},S=async t=>{try{var s,a;let n=u||(null===e||void 0===e||null===(s=e.state)||void 0===s?void 0:s.crn)||g||t;if(console.log("This is search ",n),0===(null===n||void 0===n?void 0:n.length))return;o(!0);const i=await(0,l.J4)("".concat("http://18.204.141.1:8090","/api/patient/").concat(n));v(null===i||void 0===i||null===(a=i.data)||void 0===a?void 0:a.data),setTimeout((()=>{o(!1)}),3e3)}catch(n){console.log(n)}};return(0,a.useEffect)((()=>{""!==b&&(console.log("This is running",b),x(b),S(b))}),[b]),(0,a.useEffect)((()=>{!0===s&&S()}),[s]),(0,a.useEffect)((()=>{var t,s;null!==e&&void 0!==e&&null!==(t=e.state)&&void 0!==t&&t.crn&&(x(null===e||void 0===e||null===(s=e.state)||void 0===s?void 0:s.crn),S())}),[e]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{children:[h||r?"":(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{style:{fontWeight:"bolder"},children:"Search Patient"}),(0,d.jsxs)("div",{className:"search-container",children:[(0,d.jsxs)("div",{className:"search-input",children:[(0,d.jsx)("input",{style:{paddingLeft:"5px"},className:"form-control",placeholder:"CR no. or Phone no.",type:"text",name:"search",value:u,onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),S())},onChange:e=>x(e.target.value)}),(0,d.jsx)("button",{className:"btn btn-primary searchButton",type:"button",onClick:S,children:"Search"}),null!==u&&void 0!==u&&u.length?(0,d.jsx)("button",{className:"btn btn-danger text-light clearButton",type:"button",onClick:D,children:"Clear"}):null]}),(0,d.jsx)("div",{className:"add-patient-btn",children:(0,d.jsx)("button",{type:"button",onClick:()=>{D(),p(!0)},className:"btn btn-outline-dark",children:"Add a Patient"})})]})]}),null===j||void 0===j||!j.length||h||r?(0,d.jsx)("div",{children:h?(0,d.jsx)(A,{setData:p,setUpdatedSearch:y,updatedSearch:b,getSearchByPatient:S}):(0,d.jsx)("div",{children:r?"":(0,d.jsx)("div",{className:"loaderDivInPatientPage",children:i?(0,d.jsx)(w.A,{}):"No Data"})})}):(0,d.jsx)(N,{patientSearch:j,setData:p,getSearchByPatient:S})]}),r?(0,d.jsx)(C,{}):"",(0,d.jsx)(c.N9,{})]})}},88625:(e,t,s)=>{s.d(t,{V:()=>a});var a=["512 512","<rect width='368' height='32' x='72' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"]},69833:(e,t,s)=>{s.d(t,{x:()=>a});var a=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='440 240 272 240 272 72 240 72 240 240 72 240 72 272 240 272 240 440 272 440 272 272 440 272 440 240' class='ci-primary'/>"]},56063:(e,t,s)=>{s.d(t,{Z:()=>a});var a=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M96,472a23.82,23.82,0,0,0,23.579,24H392.421A23.82,23.82,0,0,0,416,472V152H96Zm32-288H384V464H128Z' class='ci-primary'/><rect width='32' height='200' x='168' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='240' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='312' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M328,88V40c0-13.458-9.488-24-21.6-24H205.6C193.488,16,184,26.542,184,40V88H64v32H448V88ZM216,48h80V88H216Z' class='ci-primary'/>"]}}]);
//# sourceMappingURL=2214.8a9b081d.chunk.js.map