"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[2214],{72214:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var a=s(65043),l=s(63043),n=s(77154),i=s(6145),o=s(96026),c=s(69833),r=s(91036),d=s(84086),m=(s(93946),s(70579));const h=e=>{let{diagnosis:t}=e;const[s,l]=(0,a.useState)([]),[h,u]=(0,a.useState)(!1),[p,x]=(0,a.useState)({});(0,a.useEffect)((()=>{if(t&&Array.isArray(t)){const e=[...t].reverse();l(e)}}),[t]);const[v,j]=(0,a.useState)(null);return(0,m.jsxs)("div",{style:{maxHeight:"300px",marginTop:"20px"},children:[null===s||void 0===s?void 0:s.map(((e,t)=>{var s;const a=new Date(e.date).toLocaleDateString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,m.jsxs)("div",{style:{margin:"1rem"},children:[(0,m.jsx)("div",{className:"row",style:{overflowX:"auto"},children:(0,m.jsxs)("div",{style:{overflow:"auto !important"},children:[(0,m.jsxs)("h5",{children:["Diagnose Date: ",a]}),(0,m.jsxs)("table",{className:"table",style:{width:"100%",border:"1px solid",fontFamily:"ui-rounded",borderRadius:"10px"},children:[(0,m.jsxs)("colgroup",{children:[(0,m.jsx)("col",{style:{width:"20%"}}),(0,m.jsx)("col",{style:{width:"20%"}}),(0,m.jsx)("col",{style:{width:"30%"}}),(0,m.jsx)("col",{style:{width:"30%"}})]}),(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Problems"}),(0,m.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Sub Problem"}),(0,m.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Tests"}),(0,m.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Scales"})]})}),null===e||void 0===e||null===(s=e.diagnosData)||void 0===s?void 0:s.map(((e,t)=>{const{problem:s,subProblem:a,scale:l,test:c}=e;return console.log("hgsad",e),(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("tbody",{children:[h&&(0,m.jsx)(d.A,{message:"Opening File"}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{style:{fontWeight:"bolder"},children:s}),(0,m.jsx)("td",{style:{fontWeight:"bolder"},children:a||"-"}),(0,m.jsx)("td",{children:c.map(((e,t)=>{var s;return(0,m.jsx)("div",{children:""===e.name?"-":(0,m.jsxs)("div",{className:"row",style:{margin:0},children:[(0,m.jsx)("td",{style:{width:"50%",paddingRight:"10px",margin:"auto",fontWeight:"bolder"},children:e.name}),(0,m.jsx)("div",{style:{width:"50%"},children:(0,m.jsx)("td",{style:{margin:"0",padding:0},children:""!==e.testInput?(0,m.jsx)("td",{style:{width:"40%",paddingRight:"10px",margin:"auto"},children:e.testInput}):(0,m.jsx)("div",{style:{display:"flex",margin:0},children:null===(s=e.files)||void 0===s?void 0:s.map(((e,t)=>(0,m.jsx)("div",{value:e.fileName,style:{display:"flex",alignItems:"center",marginRight:"10px",margin:"0 5px 0 0"},onMouseEnter:()=>{const t=(e=>{if(e){const t=e,s=t.split("_");return s.length>1?s.slice(1).join("_").split(".")[0]:t}return""})(e.fileName);j(t)},onMouseLeave:()=>j(""),onClick:()=>(async(e,t)=>{try{u(!0);const t=await n.A.get("".concat("http://18.204.141.1:8090","/api/user/getPatientReport/").concat(e),{responseType:"blob"}),s=new Blob([t.data],{type:t.headers["content-type"]}),a=URL.createObjectURL(s);window.open(a)}catch(s){u(!1),console.error("Error fetching report:",s)}finally{u(!1)}})(null===e||void 0===e?void 0:e.fileName),children:(0,m.jsx)("button",{type:"button",className:"btn btn-sm btn-primary","data-toggle":"popover",title:v,style:{margin:"0"},children:(0,m.jsx)(i.A,{icon:o.I})})},t)))})})})]})},t)}))}),(0,m.jsx)("td",{children:l.map(((e,t)=>(0,m.jsx)("div",{children:""===e.name?"-":(0,m.jsxs)("div",{className:"row",style:{margin:0},children:[(0,m.jsx)("div",{className:"col-md-6",style:{fontWeight:"bolder",paddingRight:"10px",margin:"auto",wordWrap:"break-word"},children:e.name}),(0,m.jsx)("div",{className:"col-md-6 tableTitle",style:{margin:"0",padding:0,wordWrap:"break-word"},children:e.value})]})},t)))})]})]},t)})})),0!==(null===e||void 0===e?void 0:e.procedure.length)?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:"4",children:(0,m.jsx)("h5",{style:{fontWeight:"bolder"},children:"Procedures:"})})}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Name"}),(0,m.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Complications"}),(0,m.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Done By"}),(0,m.jsx)("td",{className:"tableTitle",style:{background:"#FBF295",fontWeight:"bold"},children:"Date"})]}),null===e||void 0===e?void 0:e.procedure.map(((e,t)=>{const s=new Date(e.date).toLocaleDateString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{children:["\xa0\xa0",e.name]}),(0,m.jsx)("td",{children:e.complications}),(0,m.jsx)("td",{children:e.doneBy}),(0,m.jsx)("td",{children:s})]},t)}))]}):""]}),(0,m.jsx)("div",{className:"row",style:{margin:"1rem auto 1rem 0"},children:(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-md-11",children:(0,m.jsx)("div",{className:"card",style:{padding:"1rem 2rem"},children:(0,m.jsx)("div",{className:"d-flex",children:(0,m.jsxs)("p",{style:{margin:"0"},children:[" ","Notes :\xa0\xa0\xa0",""===e.desc?"-":e.desc]})})})}),(0,m.jsx)("div",{className:"col-md-1 justify-content-center align-items-center",children:(0,m.jsx)(i.A,{icon:c.x,size:"xl"})})]})})})]})}),(0,m.jsx)("hr",{style:{width:"100%"}})]},t)})),(0,m.jsx)(r.N9,{})]})};var u=s(14182),p=s(66921),x=s(58390),v=s(80365),j=(s(92342),s(88625)),g=s(56063),f=s(60446),b=s.n(f);const y=e=>{var t,s,n,o,h,f,y,N,w;let{_id:D,getSearchByPatient:S,setIsAddNewDiagnosis:C,setIsDetailed:P,diagnosisProp:A}=e;console.log("Gaurav",A),console.log("PEErablem",null===(t=A[0])||void 0===t||null===(s=t.diagnosData[(null===(n=A[0])||void 0===n||null===(o=n.diagnosData)||void 0===o?void 0:o.length)-1])||void 0===s?void 0:s.problem);let k="http://18.204.141.1:8090",R=localStorage.getItem("patientRecord"),F=JSON.parse(R);const I=new Date,[E,T]=(0,a.useState)([{problem:null===(h=A[0])||void 0===h||null===(f=h.diagnosData[(null===(y=A[0])||void 0===y||null===(N=y.diagnosData)||void 0===N?void 0:N.length)-1])||void 0===f?void 0:f.problem,subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),[B,_]=(0,a.useState)([{name:"",complications:"",doneBy:"",date:b()(I)}]),[L,M]=(0,a.useState)(""),[W,z]=(0,a.useState)(!1);let[V,H]=(0,a.useState)(!1);(0,a.useEffect)((()=>{var e,t,s,a;const l=A[A.length-1],n=null===l||void 0===l?void 0:l.diagnosData[(null===l||void 0===l?void 0:l.diagnosData.length)-1];M(n),console.log("Guarssadva",n),T([{problem:null===(e=A[0])||void 0===e||null===(t=e.diagnosData[(null===(s=A[0])||void 0===s||null===(a=s.diagnosData)||void 0===a?void 0:a.length)-1])||void 0===t?void 0:t.problem,subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}])}),[]);const[O,U]=a.useState(null),[Y,Z]=(0,a.useState)({}),[J,K]=(0,a.useState)(""),[$,q]=(0,a.useState)({diagnosis:[],desc:""}),[G,X]=(0,a.useState)([]);let[Q,ee]=(0,a.useState)(!1);const[te,se]=(0,a.useState)([]),[ae,le]=(0,a.useState)([]),[ne,ie]=(0,a.useState)([]),[oe,ce]=(0,a.useState)(!1);(0,a.useEffect)((()=>{re()}),[]);const re=async()=>{try{var e,t;const s=await(0,l.J4)("".concat(k,"/api/problem/").concat(null===F||void 0===F||null===(e=F.department_id)||void 0===e?void 0:e._id)),a=null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.data[0];if(a){const e=a.problemName.filter((e=>"problem"===e.type)).map((e=>e.name)),t=a.problemName.filter((e=>"scale"===e.type)).map((e=>e.name)),s=a.problemName.filter((e=>"test"===e.type)).map((e=>{let{name:t,inputType:s}=e;return{name:t,inputType:s}}));le(s),ie(t),se(e)}}catch(s){console.error("Error fetching problems:",s)}};(0,a.useEffect)((()=>{Y.desc&&q((e=>({...e,desc:Y.desc})))}),[Y]),(0,a.useEffect)((()=>{(async()=>{try{const e=await(0,l.J4)("".concat(k,"/api/patient/").concat(D));Z(e.data.data)}catch(e){console.log(e)}})()}),[]);let[de,me]=(0,a.useState)(!1);const he=(e,t)=>{const{name:s,value:a}=t.target,l=[...E];l[e][s]=a,T(l)},ue=()=>{E.every((e=>""!==e.problem))?T([...E,{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]):r.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},pe=e=>{const t=[...E];t.splice(e,1),T(t)};(0,a.useEffect)((()=>{E.length>1?me(!0):me(!1)}),[pe,ue,he]);const xe=(e,t,s)=>{const{name:a,value:l}=s.target,n=[...E];n[e].scale[t][a]=l,T(n)},ve=(e,t)=>{const{name:s,value:a}=t.target,l=[...B];l[e][s]=a,_(l)},je=()=>{B.every((e=>""!==e.name))?_([...B,{name:"",complications:"",doneBy:"",date:b()(I)}]):r.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})};return(0,a.useEffect)((()=>{E.length>1?me(!0):me(!1),B.length>1?H(!0):H(!1)}),[pe,ue,he,je,ve]),(0,a.useEffect)((()=>{console.log("Inputs ",E)})),(0,m.jsxs)(m.Fragment,{children:[Q&&(0,m.jsx)(d.A,{loading:Q,message:"Uploading Files"}),oe&&(0,m.jsx)(d.A,{message:"Adding Diagnosis"}),(0,m.jsxs)("div",{style:{margin:"1rem auto 1rem 1rem"},children:[(0,m.jsx)("div",{className:"addPatientDataInnerDiv",children:(0,m.jsxs)("h4",{children:["Diagnosis: (",null===F||void 0===F||null===(w=F.department_id)||void 0===w?void 0:w.departmentName,")"]})}),(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),1===E.length&&""===E[0].problem)return r.oR.warning("Please select at least one Chief complaint");const t=E.map((e=>({...e,test:e.test.filter((e=>""!==e.name)),scale:e.scale.filter((e=>""!==e.name))}))).filter((e=>""!==e.problem)),s=B.filter((e=>""!==e.name));for(const l of t){if(l.test.length>0&&l.test.some((e=>""===e.testInput&&0===e.files.length)))return void r.oR.warning("Please provide input or upload file(s) for selected test(s)");if(l.scale.length>0&&l.scale.some((e=>""===e.value)))return void r.oR.warning("Please provide input for selected scale(s)")}ee(!0);try{await Promise.all(t.map((async(e,s)=>{await Promise.all(e.test.map((async(e,a)=>{if(e.files){const n=e.files;if(n.length>0){const e=new FormData;if(n.forEach((t=>{["image/jpeg","image/png","application/pdf"].includes(t.type)?e.append("files",t):console.warn("File type not allowed:",t.type)})),e.has("files")){const n=await(0,l.De)("".concat(k,"/api/user/uploadPatientReport"),e);n&&(ee(!1),t[s].test[a].files=n.filesInfo)}else ee(!1),console.warn("No valid files to upload")}}else t[s].test[a].files=null,ee(!1)})))})))}catch(a){return ee(!1),void console.error("Error uploading files:",a)}try{ce(!0);const e={...$,diagnosis:[{diagnosData:t,procedure:s,date:Date(),desc:J}],nextApointmentDate:O};await(0,l.E8)("".concat(k,"/api/patient/update/").concat(D),e)&&(X([]),K(""),r.oR.success("Patient Updated Successfully",{autoClose:1e3}),C(!1),P(!0),T([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),ce(!1),S())}catch(a){console.log(a)}},children:[(0,m.jsxs)("form",{className:"mb-3",children:[E.map(((e,t)=>(0,m.jsxs)("div",{className:"row mt-1 mb-2",children:[(0,m.jsxs)("div",{className:"col-md-2 col-12",children:[(0,m.jsx)("label",{children:(0,m.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"problem",value:e.problem,onChange:e=>he(t,e),children:[(0,m.jsx)("option",{value:"",children:"Chief complaint"}),te.map(((e,t)=>(0,m.jsx)("option",{value:e,children:e},t)))]})}),(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control",type:"text",placeholder:"Enter sub problem",name:"subProblem",onChange:e=>he(t,e)})})]}),(0,m.jsx)("div",{className:"col-md-4 col-12",children:e.test.map(((s,a)=>(0,m.jsxs)("div",{className:"d-flex mb-1",children:[(0,m.jsx)("div",{style:{width:"40%"},children:(0,m.jsx)("label",{children:(0,m.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:s.name,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...E];n[e].test[t][a]=l,T(n)})(t,a,e),children:[(0,m.jsx)("option",{value:"",children:"Select Test"}),ae.map(((e,t)=>(0,m.jsx)("option",{value:e.name,children:e.name},t)))]})})}),""===s.name?(0,m.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Select a Test",type:"text",disabled:"true"})})}):(0,m.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:ae.map((s=>{if(s.name===e.test[a].name){if("text"===s.inputType)return(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control",style:{width:"100%"},placeholder:"Enter test Value",type:"text",name:"testInput",value:e.test[a].text,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...E];n[e].test[t][a]=l,T(n)})(t,a,e)})},a);if("file"===s.inputType)return(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control",style:{width:"100%"},type:"file",multiple:!0,name:"files",accept:"image/jpeg, image/png, application/pdf",onChange:e=>((e,t,s)=>{const{name:a,files:l}=s.target,n=["image/jpeg","image/png","application/pdf"];if(l.length>3)return s.target.value="",void r.oR.warning("You can only upload up to 3 files",{autoClose:1500});const i=[...E],o=Array.from(l).filter((e=>e.size>31457280?(r.oR.warning("File size should be less than 30 MB",{autoClose:1500}),!1):!!n.includes(e.type)||(r.oR.warning("Only images and PDFs are allowed",{autoClose:1500}),!1)));i[e].test[t].files=o,T(i)})(t,a,e)})},a)}return null}))}),(0,m.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.test.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...E];a[t].test.splice(s,1),T(a)})(e,t,a),children:(0,m.jsx)(i.A,{icon:j.V})}),a===e.test.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),E[t].test[E[t].test.length-1].name){const e=[...E];e[t].test.push({name:"",testInput:"",files:[]}),T(e)}else r.oR.warning("Please Enter Previous test field before adding new")})(e,t),children:(0,m.jsx)(i.A,{icon:c.x})})]})]},s)))}),(0,m.jsx)("div",{className:"col-md-4 col-12 ",children:e.scale.map(((s,a)=>(0,m.jsxs)("div",{className:"d-flex mb-1",children:[(0,m.jsx)("div",{style:{width:"40%"},children:(0,m.jsx)("label",{children:(0,m.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:e.scale[a].name,onChange:e=>xe(t,a,e),children:[(0,m.jsx)("option",{value:"",children:"Select Scale"}),ne.map(((e,t)=>(0,m.jsx)("option",{value:e,children:e},t)))]})})}),(0,m.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Enter Scale Value",type:"text",name:"value",value:e.scale[a].value,onChange:e=>xe(t,a,e)})})}),(0,m.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.scale.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...E];a[t].scale.splice(s,1),T(a)})(e,t,a),children:(0,m.jsx)(i.A,{icon:j.V})}),a===e.scale.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),E[t].scale[E[t].scale.length-1].name){const e=[...E];e[t].scale.push({name:"",value:""}),T(e)}else r.oR.warning("Please Enter Previous Scale field before adding new")})(e,t),children:(0,m.jsx)(i.A,{icon:c.x})})]})]},a)))}),(0,m.jsx)("div",{className:"col-md-2 d-flex justify-content-end col-12",children:de&&(0,m.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>pe(t),children:(0,m.jsx)(i.A,{icon:g.Z,size:"xl"})})})]},t))),(0,m.jsx)("div",{className:"d-flex justify-content-end",children:(0,m.jsx)("button",{className:"btn btn-primary me-4",type:"button",onClick:ue,children:"Add More"})})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("input",{type:"checkbox",checked:W,onChange:()=>z(!W)}),(0,m.jsx)("label",{children:" \xa0\xa0\xa0Add Procedure"})]}),W?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("form",{children:[B.map(((e,t)=>(0,m.jsx)("div",{children:(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-md-2 col-sm-10 ",children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{onChange:e=>ve(t,e),value:e.name,name:"name",className:"form-control addPatientDataInputDiv",placeholder:"Procedure Name",type:"text"})})}),(0,m.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{onChange:e=>ve(t,e),value:e.complications,name:"complications",className:"form-control addPatientDataInputDiv",placeholder:"Complications",type:"text"})})}),(0,m.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{onChange:e=>ve(t,e),value:e.doneBy,name:"doneBy",className:"form-control addPatientDataInputDiv",placeholder:"Done By",type:"text"})})}),(0,m.jsx)("div",{className:"col-md-4 col-sm-10",children:(0,m.jsx)("div",{className:"d-flex",children:(0,m.jsx)("div",{className:"w-auto",children:(0,m.jsx)(x.$,{dateAdapter:p.R,children:(0,m.jsx)(u.j,{components:["DateTimePicker"],children:(0,m.jsx)(v.K,{label:"To",value:e.date,inputFormat:"YYYY-MM-DD",ampm:!1,ampmInClock:!1,views:["year","month","day"],slotProps:{textField:{size:"small"}}})})})})})}),(0,m.jsx)("div",{className:"col-md-2 d-flex ",children:V&&(0,m.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>(e=>{const t=[...B];t.splice(e,1),_(t)})(t),children:(0,m.jsx)(i.A,{icon:g.Z,size:"xl"})})})]})})},t))),(0,m.jsx)("div",{className:"d-flex justify-content-end",children:(0,m.jsx)("button",{className:"btn btn-primary me-4",type:"button",onClick:()=>je(),children:"Add More"})})]})}):""]}),(0,m.jsx)("div",{children:(0,m.jsx)("textarea",{rows:4,className:"form-control col-12",placeholder:"Notes (Optional)",name:"desc",value:J,onChange:e=>K(e.target.value)})}),(0,m.jsx)("div",{className:"d-flex mt-2",children:(0,m.jsx)("div",{className:"w-auto",children:(0,m.jsx)(x.$,{dateAdapter:p.R,children:(0,m.jsx)(u.j,{components:["DateTimePicker"],children:(0,m.jsx)(v.K,{label:"Next Appointment Date",value:O,onChange:e=>{U(e)}})})})})}),(0,m.jsxs)("div",{className:"text-end",children:[(0,m.jsx)("button",{type:"submit",className:"btn btn-primary mt-4",style:{width:"10rem"},children:"Submit"}),(0,m.jsx)("button",{type:"submit",className:"btn btn-danger mt-4 ms-2",style:{width:"10rem"},onClick:()=>(C(!1),void P(!0)),children:"Close"})]})]}),(0,m.jsx)(r.N9,{})]})]})},N=e=>{let{patientSearch:t,getSearchByPatient:s}=e;const[l,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[c,r]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),p=e=>{r((t=>t===e?"":e)),u(""),o(!0)},x=e=>{u(e),r(e),n(!0),o(!1)},[v,j]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{function e(){j(window.innerWidth<=768)}return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,m.jsx)("div",{children:v?(0,m.jsx)(m.Fragment,{children:null===t||void 0===t?void 0:t.map((e=>{const{name:t,crn:a,phone:r,age:u,sex:v,diagnosis:j,_id:g,desc:f,nextApointmentDate:b}=e,N=c===g,w=d===g,D=j,S=new Date(b).toLocaleString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,m.jsx)("div",{children:(0,m.jsx)("div",{style:{marginTop:"2rem"},children:(0,m.jsx)("div",{className:"card",style:{width:"100%"},children:(0,m.jsxs)("div",{className:"card-body overflow-auto ",children:[(0,m.jsxs)("div",{className:"row",style:{marginBottom:"1rem"},children:[(0,m.jsxs)("div",{style:{width:"40%"},children:[(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"boldFont",children:"CR No :"})," ",a]}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"boldFont",children:"Age : "})," ",u]}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"boldFont",children:"Sex. "})," ",v]})]}),(0,m.jsxs)("div",{style:{width:"60%"},children:[(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"boldFont",children:"Name : "})," ",t]}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"boldFont",children:"Mob. No."})," ",r]}),(0,m.jsx)("br",{}),(0,m.jsxs)("span",{children:[(0,m.jsx)("span",{className:"boldFont",children:"Next Appointment Date."})," ",b?S:"-"]})]})]}),(0,m.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,m.jsx)("button",{type:"button",className:"btn btn-success patientInfoButton",onClick:()=>p(g),children:"Show Diagnosis"}),(0,m.jsx)("button",{type:"button",className:"btn btn-warning",style:{marginLeft:"2rem"},onClick:()=>x(g),children:j?"Add New Follow-Up":"Add New Diagnosis"})]}),N&&i&&(0,m.jsx)("div",{children:(0,m.jsx)(h,{diagnosis:j,desc:f})}),w&&l&&(0,m.jsx)("div",{children:(0,m.jsx)(y,{_id:g,getSearchByPatient:s,setIsAddNewDiagnosis:n,setIsDetailed:o,diagnosisProp:D})})]})})})},g)}))}):(0,m.jsx)("div",{className:"mb-4",children:null===t||void 0===t?void 0:t.map((e=>{const{name:t,crn:a,phone:r,age:u,sex:v,diagnosis:j,_id:g,desc:f,nextApointmentDate:b}=e,N=c===g,w=d===g,D=j,S=new Date(b).toLocaleString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{style:{marginTop:"2rem"},children:(0,m.jsx)("div",{className:"card",style:{width:"100%"},children:(0,m.jsxs)("div",{className:"card-body overflow-auto ",children:[(0,m.jsxs)("h5",{className:"card-title",children:[" CR No : ",a]}),(0,m.jsx)("h6",{className:"card-subtitle mt-2",children:(0,m.jsxs)("h5",{children:["Name : ",t]})}),(0,m.jsxs)("div",{style:{display:"flex",marginTop:"1rem"},children:[(0,m.jsxs)("span",{style:{display:"flex"},children:[(0,m.jsx)("h6",{children:"Phone No. \xa0"})," ",(0,m.jsx)("h6",{style:{fontWeight:"normal"},children:r})]}),(0,m.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,m.jsx)("h6",{children:"Age. \xa0"})," ",(0,m.jsx)("h6",{style:{fontWeight:"normal"},children:u})]}),(0,m.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,m.jsx)("h6",{children:" Sex. \xa0"})," ",(0,m.jsx)("h6",{style:{fontWeight:"normal"},children:v})]}),(0,m.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,m.jsx)("h6",{children:"Next Appointment Date. \xa0"})," ",(0,m.jsx)("h6",{style:{fontWeight:"normal"},children:b?S:"-"})]})]}),(0,m.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,m.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>p(g),style:{fontSize:"15px",whiteSpace:"none",padding:"5px 10px"},children:"Show Diagnosis"}),(0,m.jsx)("button",{type:"button",className:"btn btn-warning",style:{marginLeft:"2rem"},onClick:()=>x(g),children:j?"Add New Follow-Up":"Add New Diagnosis"})]}),N&&i&&(0,m.jsx)("div",{children:(0,m.jsx)(h,{diagnosis:j,desc:f})}),w&&l&&(0,m.jsxs)("div",{children:[(0,m.jsx)(y,{_id:g,getSearchByPatient:s,setIsAddNewDiagnosis:n,setIsDetailed:o,diagnosisProp:D}),(0,m.jsx)(h,{diagnosis:j,desc:f})]})]})})})},g)}))})})};var w=s(63483),D=s(81637),S=s(96446);const C=()=>(0,m.jsx)(S.A,{style:{width:"100%",height:"100%",lineHeight:"20vh",textAlign:"center",marginTop:"10px"},children:(0,m.jsx)(D.A,{})});var P=s(73216);s(83910);const A=e=>{var t;let{setData:s,setUpdatedSearch:n,getSearchByPatient:o,updatedSearch:h}=e;(0,P.zy)();const f=new Date;let y="http://18.204.141.1:8090",N=localStorage.getItem("patientRecord"),w=JSON.parse(N);const[D,S]=(0,a.useState)(!1),[C,A]=(0,a.useState)(!1),[k,R]=(0,a.useState)(!1),[F,I]=a.useState(null),[E,T]=(0,a.useState)([]),[B,_]=(0,a.useState)([]),[L,M]=(0,a.useState)([]),[W,z]=(0,a.useState)(""),V=Math.floor(9e3*Math.random())+1e3;let[H,O]=(0,a.useState)(!1);const[U,Y]=(0,a.useState)(!1),[Z,J]=(0,a.useState)(""),[K,$]=(0,a.useState)({name:"",age:"",sex:"male",phone:"",crn:"".concat(V),diagnosis:[],desc:"",doctor_id:null===w||void 0===w?void 0:w._id}),[q,G]=(0,a.useState)([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),[X,Q]=(0,a.useState)([{name:"",complications:"",doneBy:"",date:b()(f)}]);(0,a.useEffect)((()=>{ee()}),[]);const ee=async()=>{try{var e,t;const s=await(0,l.J4)("".concat(y,"/api/problem/").concat(null===w||void 0===w||null===(e=w.department_id)||void 0===e?void 0:e._id)),a=null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.data[0];if(a){const e=a.problemName.filter((e=>"problem"===e.type)).map((e=>e.name)),t=a.problemName.filter((e=>"scale"===e.type)).map((e=>e.name)),s=a.problemName.filter((e=>"test"===e.type)).map((e=>{let{name:t,inputType:s}=e;return{name:t,inputType:s}}));_(s),M(t),T(e)}}catch(s){console.error("Error fetching problems:",s)}};let[te,se]=(0,a.useState)(!1),[ae,le]=(0,a.useState)(!1);const ne=(e,t)=>{const{name:s,value:a}=t.target,l=[...q];l[e][s]=a,G(l)},ie=(e,t)=>{const{name:s,value:a}=t.target,l=[...X];l[e][s]=a,Q(l)},oe=()=>{q.every((e=>""!==e.problem))?G([...q,{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]):r.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},ce=()=>{X.every((e=>""!==e.name))?Q([...X,{name:"",complications:"",doneBy:"",date:b()(f)}]):r.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},re=e=>{const t=[...q];t.splice(e,1),G(t)};(0,a.useEffect)((()=>{q.length>1?se(!0):se(!1),X.length>1?le(!0):le(!1)}),[re,oe,ne,ce,ce,ie]),(0,a.useEffect)((()=>{console.log("Updated inputs:",q,X)}),[q]);const de=(e,t,s)=>{const{name:a,value:l}=s.target,n=[...q];n[e].scale[t][a]=l,G(n)};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{children:[H&&(0,m.jsx)(d.A,{loading:H}),(0,m.jsx)("div",{className:"content-to-be-blurred",children:(0,m.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("hr",{}),(0,m.jsx)("h4",{children:"Patient Details"}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-md-4",children:(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Name ",(0,m.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,m.jsx)("div",{className:"col-sm-8",children:(0,m.jsx)("input",{type:"text",className:"form-control ",name:"name",value:K.name,onChange:e=>$({...K,name:e.target.value})})})]})}),(0,m.jsx)("div",{className:"col-md-4",children:(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Age ",(0,m.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,m.jsx)("div",{className:"col-sm-8",children:(0,m.jsx)("input",{type:"number",className:"form-control ",name:"age",value:K.age,onChange:e=>$({...K,age:e.target.value})})})]})}),(0,m.jsx)("div",{className:"col-md-4",children:(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Sex ",(0,m.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,m.jsx)("div",{className:"col-sm-8",children:(0,m.jsxs)("select",{className:"form-control ",name:"sex",value:K.sex,onChange:e=>$({...K,sex:e.target.value}),children:[(0,m.jsx)("option",{value:"male",children:"Male"}),(0,m.jsx)("option",{value:"female",children:"Female"}),(0,m.jsx)("option",{value:"other",children:"Other"})]})})]})})]}),(0,m.jsxs)("div",{className:"row ",children:[(0,m.jsx)("div",{className:"col-md-4 mt-2",children:(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"col-lg-4 patientNamediv",children:["Contact ",(0,m.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,m.jsx)("div",{className:" col-lg-8 col-sm-8",children:(0,m.jsx)("input",{className:"form-control ",type:"text",name:"phone",value:K.phone,onChange:e=>{(/^\d*$/.test(e.target.value)||""===e.target.value)&&$({...K,phone:e.target.value})},required:!0})})]})}),(0,m.jsx)("div",{className:"col-md-4 mt-2",children:(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"col-sm-4  patientNamediv",children:["CR No ",(0,m.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,m.jsx)("div",{className:"col-sm-8",children:(0,m.jsx)("input",{className:"form-control ",type:"test",name:"crn",value:K.crn,onChange:e=>$({...K,crn:e.target.value}),required:!0})})]})})]})]}),(0,m.jsx)("hr",{}),(0,m.jsx)("div",{className:"addPatientDataInnerDiv",children:(0,m.jsxs)("h4",{children:["Diagnosis: (",null===w||void 0===w||null===(t=w.department_id)||void 0===t?void 0:t.departmentName,")"]})}),(0,m.jsx)("div",{children:(0,m.jsxs)("form",{className:"mb-3",children:[q.map(((e,t)=>(0,m.jsxs)("div",{className:"row mt-1 mb-2",children:[(0,m.jsxs)("div",{className:"col-md-2 col-12",children:[(0,m.jsx)("label",{children:(0,m.jsxs)("select",{className:"form-control addPatientDataSelectDiv mb-1",name:"problem",value:e.problem,onChange:e=>ne(t,e),children:[(0,m.jsx)("option",{value:"",children:"Chief complaint"}),E.map(((e,t)=>(0,m.jsx)("option",{value:e,children:e},t)))]})}),(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control",type:"text",placeholder:"Enter sub problem",name:"subProblem",onChange:e=>ne(t,e)})})]}),(0,m.jsx)("div",{className:"col-md-4 col-12",children:e.test.map(((s,a)=>(0,m.jsxs)("div",{className:"d-flex mb-1",children:[(0,m.jsx)("div",{style:{width:"40%"},children:(0,m.jsx)("label",{children:(0,m.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:s.name,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...q];n[e].test[t][a]=l,G(n)})(t,a,e),children:[(0,m.jsx)("option",{value:"",children:"Select Test"}),B.map(((e,t)=>(0,m.jsx)("option",{value:e.name,children:e.name},t)))]})})}),""===s.name?(0,m.jsx)("div",{style:{width:"40%",marginLeft:"4px"},children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Select a Test",type:"text",disabled:"true"})})}):(0,m.jsx)("div",{style:{width:"40%",marginLeft:"4px"},children:B.map((s=>{if(s.name===e.test[a].name){if("text"===s.inputType)return(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control",style:{width:"100%"},placeholder:"Enter test Value",type:"text",name:"testInput",value:e.test[a].text,onChange:e=>((e,t,s)=>{const{name:a,value:l}=s.target,n=[...q];n[e].test[t][a]=l,console.log("guarav",n)})(t,a,e)})},a);if("file"===s.inputType)return(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control",style:{width:"100%"},type:"file",multiple:!0,name:"files",accept:"image/jpeg, image/png, application/pdf",onChange:e=>((e,t,s)=>{const{name:a,files:l}=s.target,n=["image/jpeg","image/png","application/pdf"];if(l.length>3)return s.target.value="",void r.oR.warning("You can only upload up to 3 files",{autoClose:1500});const i=[...q],o=Array.from(l).filter((e=>e.size>31457280?(r.oR.warning("File size should be less than 30 MB",{autoClose:1500}),!1):!!n.includes(e.type)||(r.oR.warning("Only images and PDFs are allowed",{autoClose:1500}),!1)));i[e].test[t].files=o,G(i)})(t,a,e)})},a)}return null}))}),(0,m.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.test.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...q];a[t].test.splice(s,1),G(a)})(e,t,a),children:(0,m.jsx)(i.A,{icon:j.V})}),a===e.test.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),q[t].test[q[t].test.length-1].name){const e=[...q];e[t].test.push({name:"",testInput:"",files:[]}),G(e)}else r.oR.warning("Please Enter Previous test field before adding new")})(e,t),children:(0,m.jsx)(i.A,{icon:c.x})})]})]},s)))}),(0,m.jsx)("div",{className:"col-md-4 col-12 ",children:e.scale.map(((s,a)=>(0,m.jsxs)("div",{className:"d-flex mb-1",children:[(0,m.jsx)("div",{style:{width:"40%"},children:(0,m.jsx)("label",{children:(0,m.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"name",value:e.scale[a].name,onChange:e=>de(t,a,e),children:[(0,m.jsx)("option",{value:"",children:"Select Scale"}),L.map(((e,t)=>(0,m.jsx)("option",{value:e,children:e},t)))]})})}),(0,m.jsx)("div",{style:{width:"40%",marginLeft:"3px"},children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Enter Scale Value",type:"text",name:"value",value:e.scale[a].value,onChange:e=>de(t,a,e)})})}),(0,m.jsxs)("div",{style:{width:"20%",marginLeft:"3px"},children:[a!==e.scale.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-dark",onClick:e=>((e,t,s)=>{e.preventDefault();const a=[...q];a[t].scale.splice(s,1),G(a)})(e,t,a),children:(0,m.jsx)(i.A,{icon:j.V})}),a===e.scale.length-1&&(0,m.jsx)("button",{className:"btn btn-outline-success",onClick:e=>((e,t)=>{if(e.preventDefault(),q[t].scale[q[t].scale.length-1].name){const e=[...q];e[t].scale.push({name:"",value:""}),G(e)}else r.oR.warning("Please Enter Previous Scale field before adding new")})(e,t),children:(0,m.jsx)(i.A,{icon:c.x})})]})]},a)))}),(0,m.jsx)("div",{className:"col-md-2 d-flex justify-content-end col-12",children:te&&(0,m.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>re(t),children:(0,m.jsx)(i.A,{icon:g.Z,size:"xl"})})})]},t))),(0,m.jsx)("div",{className:"d-flex justify-content-end",children:(0,m.jsx)("button",{className:"btn btn-outline-primary me-4",type:"button",onClick:oe,children:"Add More"})})]})}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("input",{type:"checkbox",checked:U,onChange:()=>Y(!U)}),(0,m.jsx)("label",{children:" \xa0\xa0\xa0Add Procedure"})]}),U?(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("form",{children:[X.map(((e,t)=>(0,m.jsx)("div",{children:(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"row",children:[(0,m.jsx)("div",{className:"col-md-2 col-sm-10 ",children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{onChange:e=>ie(t,e),value:e.name,name:"name",className:"form-control addPatientDataInputDiv",placeholder:"Procedure Name",type:"text"})})}),(0,m.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{onChange:e=>ie(t,e),value:e.complications,name:"complications",className:"form-control addPatientDataInputDiv",placeholder:"Complications",type:"text"})})}),(0,m.jsx)("div",{className:"col-md-2 col-sm-10",children:(0,m.jsx)("label",{children:(0,m.jsx)("input",{onChange:e=>ie(t,e),value:e.doneBy,name:"doneBy",className:"form-control addPatientDataInputDiv",placeholder:"Done By",type:"text"})})}),(0,m.jsx)("div",{className:"col-md-4 col-sm-10",children:(0,m.jsx)("div",{className:"d-flex",children:(0,m.jsx)("div",{className:"w-auto",children:(0,m.jsx)(x.$,{dateAdapter:p.R,children:(0,m.jsx)(u.j,{components:["DateTimePicker"],children:(0,m.jsx)(v.K,{label:"To",value:e.date,inputFormat:"YYYY-MM-DD",ampm:!1,ampmInClock:!1,views:["year","month","day"],slotProps:{textField:{size:"small"}}})})})})})}),(0,m.jsx)("div",{className:"col-md-2 d-flex ",children:ae&&(0,m.jsx)("button",{className:"btn me-4 mt-1",type:"button",onClick:()=>(e=>{const t=[...X];t.splice(e,1),Q(t)})(t),children:(0,m.jsx)(i.A,{icon:g.Z,size:"xl"})})})]})})},t))),(0,m.jsx)("div",{className:"d-flex justify-content-end",children:(0,m.jsx)("button",{className:"btn btn-outline-primary me-4",type:"button",onClick:ce,children:"Add More"})})]})}):""]}),(0,m.jsx)("div",{children:(0,m.jsx)("textarea",{rows:4,className:"form-control col-12",placeholder:"Notes (Optional)",name:"desc",value:Z,onChange:e=>J(e.target.value)})})]}),(0,m.jsx)("div",{children:(0,m.jsx)("div",{className:"d-flex mt-2",children:(0,m.jsx)("div",{className:"w-auto",children:(0,m.jsx)(x.$,{dateAdapter:p.R,children:(0,m.jsx)(u.j,{components:["DateTimePicker"],children:(0,m.jsx)(v.K,{label:"Next Appointment Date",value:F,onChange:e=>{I(e)}})})})})})}),(0,m.jsxs)("div",{className:"text-end m-4",children:[(0,m.jsx)("button",{className:"btn btn-info mt-3 mx-2 w-auto",onClick:async()=>{if(!K.name||!K.age||!K.sex||!K.phone||!K.crn)return r.oR.warning("Please fill all Patient details");if(1===q.length&&""===q[0].problem)return r.oR.warning("Please select at least one Chief complaint");const e=q.map((e=>({...e,test:e.test.filter((e=>""!==e.name)),scale:e.scale.filter((e=>""!==e.name))}))).filter((e=>""!==e.problem)),t=X.filter((e=>""!==e.name));for(const s of e){if(s.test.length>0&&s.test.some((e=>""===e.testInput&&0===e.files.length)))return void r.oR.warning("Please provide input or upload file(s) for selected test(s)");if(s.scale.length>0&&s.scale.some((e=>""===e.value)))return void r.oR.warning("Please provide input for selected scale(s)")}O(!0);try{await Promise.all(e.map((async(t,s)=>{await Promise.all(t.test.map((async(t,a)=>{if(t.files){const n=t.files;if(n.length>0){const t=new FormData;if(n.forEach((e=>{["image/jpeg","image/png","application/pdf"].includes(e.type)?t.append("files",e):console.warn("File type not allowed:",e.type)})),t.has("files")){const n=await(0,l.De)("".concat(y,"/api/user/uploadPatientReport"),t);n&&(O(!1),e[s].test[a].files=n.filesInfo)}else O(!1),console.warn("No valid files to upload")}}else e[s].test[a].files=null,O(!1)})))})))}catch(c){return O(!1),void console.error("Error uploading files:",c)}const a={...K,diagnosis:[{diagnosData:e,procedure:t,date:Date(),desc:Z}],nextApointmentDate:F};console.log("final input",a);try{var i,o;const e=await localStorage.getItem("patientRecord"),t=null===(i=JSON.parse(e))||void 0===i?void 0:i._id,c=await(0,l.Hl)("".concat(y,"/api/patient/create/").concat(t),a);!0===c.success&&(r.oR.success("Patient Created Successfully",{autoClose:2e3}),O(!1),R(!0),s(!1),S(!0),R(!1),J(""),I(null),G([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),Q({name:"",complications:"",doneBy:"",date:b()(f)}),$({name:"",age:"",sex:"male",phone:"",crn:"".concat(V),diagnosis:[],desc:"",doctor_id:null===w||void 0===w?void 0:w._id})),"phone Already Exists"===c.message&&(r.oR.warning("phone Already Exists"),O(!1)),"Crn Already Exists"===c.message&&(r.oR.warning("Crn Already Exists"),O(!1)),n(null===c||void 0===c||null===(o=c.data)||void 0===o?void 0:o.crn)}catch(c){r.oR.warning("Something went wrong"),O(!1),console.error("Error submitting data:",c)}},children:"Submit"}),(0,m.jsx)("button",{className:"btn btn-info mt-3 w-auto",onClick:()=>{s(!1),G([{problem:"",subProblem:"",test:[{name:"",testInput:"",files:[]}],scale:[{name:"",value:""}]}]),$({name:"",age:"",sex:"male",phone:"",crn:"".concat(V),diagnosis:[],desc:"",doctor_id:null===w||void 0===w?void 0:w._id})},children:"Close"})]})]})})]}),(0,m.jsx)(r.N9,{})]})},k=()=>{const e=(0,P.zy)();let t=localStorage.getItem("patientRecord");JSON.parse(t);const[s,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),[h,u]=(0,a.useState)(!1),[p,x]=(0,a.useState)(""),[v,j]=(0,a.useState)([]),[g,f]=(0,a.useState)(""),[b,y]=(0,a.useState)("");(0,a.useEffect)((()=>{x("");const t=new URLSearchParams(e.search).get("crn");t&&f(t)}),[]),(0,a.useEffect)((()=>{""!==g&&S()}),[g]);const D=()=>{try{x(""),j([])}catch(e){console.log(e)}},S=async t=>{try{var s,a;let n=p||(null===e||void 0===e||null===(s=e.state)||void 0===s?void 0:s.crn)||g||t;if(console.log("This is search ",n),0===(null===n||void 0===n?void 0:n.length))return;o(!0);const i=await(0,l.J4)("".concat("http://18.204.141.1:8090","/api/patient/").concat(n));j(null===i||void 0===i||null===(a=i.data)||void 0===a?void 0:a.data),o(!1)}catch(n){console.log(n)}};return(0,a.useEffect)((()=>{""!==b&&(console.log("This is running",b),x(b),S(b))}),[b]),(0,a.useEffect)((()=>{!0===s&&S()}),[s]),(0,a.useEffect)((()=>{var t,s;null!==e&&void 0!==e&&null!==(t=e.state)&&void 0!==t&&t.crn&&(x(null===e||void 0===e||null===(s=e.state)||void 0===s?void 0:s.crn),S())}),[e]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{children:[h||c?"":(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{style:{fontWeight:"bolder"},children:"Search Patient"}),(0,m.jsxs)("div",{className:"search-container",children:[(0,m.jsxs)("div",{className:"search-input",children:[(0,m.jsx)("input",{style:{paddingLeft:"5px"},className:"form-control",placeholder:"CR no. or Phone no.",type:"text",name:"search",value:p,onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),S())},onChange:e=>x(e.target.value)}),(0,m.jsx)("button",{className:"btn btn-primary searchButton",type:"button",onClick:S,children:"Search"}),null!==p&&void 0!==p&&p.length?(0,m.jsx)("button",{className:"btn btn-danger text-light clearButton",type:"button",onClick:D,children:"Clear"}):null]}),(0,m.jsx)("div",{className:"add-patient-btn",children:(0,m.jsx)("button",{type:"button",onClick:()=>{D(),u(!0)},className:"btn btn-outline-dark",children:"Add a Patient"})})]})]}),null===v||void 0===v||!v.length||h||c?(0,m.jsx)("div",{children:h?(0,m.jsx)(A,{setData:u,setUpdatedSearch:y,updatedSearch:b,getSearchByPatient:S}):(0,m.jsx)("div",{children:c?"":(0,m.jsx)("div",{className:"loaderDivInPatientPage",children:i?(0,m.jsx)(w.A,{}):"No Data"})})}):(0,m.jsx)(N,{patientSearch:v,setData:u,getSearchByPatient:S})]}),c?(0,m.jsx)(C,{}):"",(0,m.jsx)(r.N9,{})]})}},88625:(e,t,s)=>{s.d(t,{V:()=>a});var a=["512 512","<rect width='368' height='32' x='72' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"]},69833:(e,t,s)=>{s.d(t,{x:()=>a});var a=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='440 240 272 240 272 72 240 72 240 240 72 240 72 272 240 272 240 440 272 440 272 272 440 272 440 240' class='ci-primary'/>"]},56063:(e,t,s)=>{s.d(t,{Z:()=>a});var a=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M96,472a23.82,23.82,0,0,0,23.579,24H392.421A23.82,23.82,0,0,0,416,472V152H96Zm32-288H384V464H128Z' class='ci-primary'/><rect width='32' height='200' x='168' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='240' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='200' x='312' y='216' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M328,88V40c0-13.458-9.488-24-21.6-24H205.6C193.488,16,184,26.542,184,40V88H64v32H448V88ZM216,48h80V88H216Z' class='ci-primary'/>"]}}]);
//# sourceMappingURL=2214.c84fa008.chunk.js.map