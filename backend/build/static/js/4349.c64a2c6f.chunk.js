"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[4349],{4349:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var l=s(65043),a=s(63043),n=s(77154),i=s(6145),o=s(96026),c=s(91036),r=s(84086),d=s(70579);const m=e=>{let{diagnosis:t}=e;console.log("Guarva",t);const[s,a]=(0,l.useState)([]),[m,h]=(0,l.useState)(!1),[u,p]=(0,l.useState)({});(0,l.useEffect)((()=>{if(t&&Array.isArray(t)){const e=[...t].reverse();a(e)}}),[t]);const[x,v]=(0,l.useState)(null);return(0,d.jsxs)("div",{style:{maxHeight:"300px",marginTop:"20px"},children:[null===s||void 0===s?void 0:s.map(((e,t)=>{var s;const l=new Date(e.date).toLocaleDateString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,d.jsxs)("div",{style:{margin:"1rem"},children:[(0,d.jsx)("div",{className:"row",style:{overflowX:"auto"},children:(0,d.jsxs)("div",{style:{overflow:"auto !important"},children:[(0,d.jsxs)("h5",{children:["Diagnose Date: ",l]}),(0,d.jsxs)("table",{className:"table",style:{width:"100%",border:"1px solid",fontFamily:"ui-rounded",borderRadius:"10px"},children:[(0,d.jsxs)("colgroup",{children:[(0,d.jsx)("col",{style:{width:"20%"}}),(0,d.jsx)("col",{style:{width:"20%"}}),(0,d.jsx)("col",{style:{width:"20%"}}),(0,d.jsx)("col",{style:{width:"20%"}}),(0,d.jsx)("col",{style:{width:"20%"}})]}),(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Problems"}),(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Test"}),(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Test value"}),(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Scale"}),(0,d.jsx)("th",{scope:"col",className:"tableTitle",style:{background:"#FBF295"},children:"Scale value"})]})}),null===e||void 0===e||null===(s=e.diagnosData)||void 0===s?void 0:s.map(((e,t)=>{const{problem:s,scale:l,test:a,testInput:c,files:u,value:p}=e;return(0,d.jsxs)("tbody",{children:[m&&(0,d.jsx)(r.A,{message:"Opening File"}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"tableTitle",style:{fontWeight:"bolder"},children:s}),(0,d.jsx)("td",{className:"tableTitle",style:{fontWeight:"bolder"},children:""===a?"-":a}),(0,d.jsx)("td",{className:"tableTitle",style:{fontWeight:"bolder"},children:c||(0,d.jsx)("div",{style:{display:"flex"},children:null===u||void 0===u?void 0:u.map(((e,t)=>(0,d.jsx)("div",{value:e.fileName,style:{display:"flex",alignItems:"center",marginRight:"10px"},onMouseEnter:()=>{const t=(e=>{if(e){const t=e,s=t.split("_");return s.length>1?s.slice(1).join("_").split(".")[0]:t}return""})(e.fileName);v(t)},onMouseLeave:()=>v(""),onClick:()=>(async(e,t)=>{try{h(!0);const t=await n.A.get("".concat("http://18.204.141.1:8090","/api/user/getPatientReport/").concat(e),{responseType:"blob"}),s=new Blob([t.data],{type:t.headers["content-type"]}),l=URL.createObjectURL(s);window.open(l)}catch(s){h(!1),console.error("Error fetching report:",s)}finally{h(!1)}})(null===e||void 0===e?void 0:e.fileName),children:(0,d.jsx)("button",{type:"button",className:"btn btn-sm btn-primary","data-toggle":"popover",title:x,style:{margin:"0"},children:(0,d.jsx)(i.A,{icon:o.I})})},t)))})}),console.log("Guarav",c),(0,d.jsx)("td",{className:"tableTitle",style:{fontWeight:"bolder"},children:""===l?"-":l}),(0,d.jsx)("td",{className:"tableTitle",style:{fontWeight:"bolder"},children:""===p?"-":p})]})]},t)}))]}),(0,d.jsx)("div",{className:"row",style:{margin:"1rem auto 1rem 0",width:"90%"},children:(0,d.jsx)("div",{children:(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-md-2 d-flex align-items-center",children:(0,d.jsx)("h5",{children:"Notes:"})}),(0,d.jsx)("div",{className:"col-md-10 d-flex align-items-center",children:(0,d.jsx)("div",{className:"card",style:{width:"87%",padding:"1rem 2rem"},children:(0,d.jsx)("p",{style:{margin:"0"},children:""===e.desc?"-":e.desc})})})]})})})]})}),(0,d.jsx)("hr",{style:{width:"100%"}})]},t)})),(0,d.jsx)(c.N9,{})]})};var h=s(14182),u=s(66921),p=s(58390),x=s(80365);s(92342);const v=e=>{var t;let{_id:s,getSearchByPatient:n,setIsAddNewDiagnosis:i,setIsDetailed:o,diagnosisProp:m}=e,v="http://18.204.141.1:8090",j=localStorage.getItem("patientRecord"),g=JSON.parse(j);const[f,y]=(0,l.useState)([{problem:"",test:"",testInput:"",files:[],scale:"",value:""}]),[b,N]=(0,l.useState)("");(0,l.useEffect)((()=>{const e=m[m.length-1],t=null===e||void 0===e?void 0:e.diagnosData[(null===e||void 0===e?void 0:e.diagnosData.length)-1];N(t),console.log("Guarssadva",t),y([{problem:null===t||void 0===t?void 0:t.problem,test:"",testInput:"",files:[],scale:"",value:""}])}),[]);const[w,S]=l.useState(null),[D,C]=(0,l.useState)({}),[P,A]=(0,l.useState)(""),[R,I]=(0,l.useState)({diagnosis:[],desc:""}),[F,E]=(0,l.useState)([]);let[T,_]=(0,l.useState)(!1);const[k,B]=(0,l.useState)([]),[L,W]=(0,l.useState)([]),[O,z]=(0,l.useState)([]),[M,U]=(0,l.useState)(!1);(0,l.useEffect)((()=>{J()}),[]);const J=async()=>{try{var e,t;const s=await(0,a.J4)("".concat(v,"/api/problem/").concat(null===g||void 0===g||null===(e=g.department_id)||void 0===e?void 0:e._id)),l=null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.data[0];if(l){const e=l.problemName.filter((e=>"problem"===e.type)).map((e=>e.name)),t=l.problemName.filter((e=>"scale"===e.type)).map((e=>e.name)),s=l.problemName.filter((e=>"test"===e.type)).map((e=>{let{name:t,inputType:s}=e;return{name:t,inputType:s}}));W(s),z(t),B(e)}}catch(s){console.error("Error fetching problems:",s)}};(0,l.useEffect)((()=>{D.desc&&I((e=>({...e,desc:D.desc})))}),[D]),(0,l.useEffect)((()=>{(async()=>{try{const e=await(0,a.J4)("".concat(v,"/api/patient/").concat(s));C(e.data.data)}catch(e){console.log(e)}})()}),[]);let[V,G]=(0,l.useState)(!1);const H=(e,t)=>{const{name:s,value:l}=t.target,a=[...f];a[e][s]=l,y(a)},K=()=>{f.every((e=>""!==e.problem))?y([...f,{problem:"",test:"",testInput:"",files:[],scale:"",value:""}]):c.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},$=e=>{const t=[...f];t.splice(e,1),y(t)};return(0,l.useEffect)((()=>{f.length>1?G(!0):G(!1)}),[$,K,H]),(0,d.jsxs)(d.Fragment,{children:[T&&(0,d.jsx)(r.A,{loading:T,message:"Uploading Files"}),M&&(0,d.jsx)(r.A,{message:"Adding Diagnosis"}),(0,d.jsxs)("div",{style:{margin:"1rem auto 1rem 1rem"},children:[(0,d.jsx)("div",{className:"addPatientDataInnerDiv",children:(0,d.jsxs)("h4",{children:["Diagnosis: (",null===g||void 0===g||null===(t=g.department_id)||void 0===t?void 0:t.departmentName,")"]})}),(0,d.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),1===f.length&&""===f[0].problem)return c.oR.warning("Please select at least one Chief complaint");const t=f.filter((e=>""!==e.problem));for(const s of t){if(""!==s.test&&""===s.testInput&&0===s.files.length)return void c.oR.warning("Please give input for selected test");if(""!==s.scale&&""===s.value)return void c.oR.warning("Please give input for selected scale");console.log("data",s)}_(!0);try{await Promise.all(t.map((async(e,s)=>{if(e.files){const l=e.files;if(l.length>0){const e=new FormData;if(l.forEach((t=>{["image/jpeg","image/png","application/pdf"].includes(t.type)?e.append("files",t):console.warn("File type not allowed:",t.type)})),e.has("files")){const l=await(0,a.De)("".concat(v,"/api/user/uploadPatientReport"),e);l&&(_(!1),t[s].files=l.filesInfo)}else console.warn("No valid files to upload")}}else t[s].files=null})))}catch(l){return _(!1),void console.error("Error uploading files:",l)}try{U(!0);const e={...R,diagnosis:[{diagnosData:t,date:Date(),desc:P}],nextApointmentDate:w};await(0,a.E8)("".concat(v,"/api/patient/update/").concat(s),e)&&(E([]),A(""),c.oR.success("Patient Updated Successfully",{autoClose:1e3}),i(!1),o(!0),y([{problem:"",test:"",testInput:"",files:[],scale:"",value:""}]),U(!1),n())}catch(l){console.log(l)}},children:[(0,d.jsxs)("form",{className:"mb-3",children:[f.map(((e,t)=>(0,d.jsxs)("div",{className:"row mt-1 mb-2",children:[(0,d.jsx)("div",{className:"col-md-2 col-12",children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv ",name:"problem",value:e.problem,onChange:e=>H(t,e),children:[(0,d.jsx)("option",{value:"",children:"Chief complaint"}),k.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})})}),(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"test",value:e.test,onChange:e=>H(t,e),children:[(0,d.jsx)("option",{value:"",children:"Select Test"}),L.map(((e,t)=>(0,d.jsx)("option",{value:e.name,children:e.name},t)))]})})}),""===e.test?(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Select a Test",type:"text",disabled:"true"})})}):(0,d.jsx)("div",{className:"col-md-2 col-6",children:L.map(((s,l)=>{if(s.name===e.test){if("text"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},placeholder:"Enter test Value",type:"text",name:"testInput",value:e.testInput.text,onChange:e=>((e,t)=>{const{name:s,value:l}=t.target,a=[...f];a[e][s]=l,y(a)})(t,e)})},l);if("file"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},type:"file",multiple:!0,name:"files",accept:"image/jpeg, image/png, application/pdf",onChange:e=>((e,t)=>{const{name:s,files:l}=t.target,a=["image/jpeg","image/png","application/pdf"];if(l.length>3)return t.target.value="",void c.oR.warning("You can only upload up to 3 files",{autoClose:1500});const n=[...f],i=Array.from(l).filter((e=>e.size>31457280?(c.oR.warning("File size should be less than 30 MB",{autoClose:1500}),!1):!!a.includes(e.type)||(c.oR.warning("Only images and PDFs are allowed",{autoClose:1500}),!1)));n[e][s]=i,y(n)})(t,e)})},l)}return null}))}),(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"scale",value:e.scale,onChange:e=>H(t,e),children:[(0,d.jsx)("option",{value:"",children:"Select Scale"}),O.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})})}),(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Enter Scale Value",type:"text",name:"value",value:e.value,onChange:e=>H(t,e)})})}),(0,d.jsx)("div",{className:"col-md-2 d-flex justify-content-center",children:V&&(0,d.jsx)("button",{className:"btn btn-danger",type:"button",onClick:()=>$(t),children:"Remove"})})]},t))),(0,d.jsx)("div",{className:"d-flex justify-content-end",children:(0,d.jsx)("button",{className:"btn btn-primary me-4",type:"button",onClick:K,children:"Add More"})})]}),(0,d.jsx)("div",{children:(0,d.jsx)("textarea",{rows:4,className:"form-control col-12",placeholder:"Notes (Optional)",name:"desc",value:P,onChange:e=>A(e.target.value)})}),(0,d.jsx)("div",{className:"d-flex mt-2",children:(0,d.jsx)("div",{className:"w-auto",children:(0,d.jsx)(p.$,{dateAdapter:u.R,children:(0,d.jsx)(h.j,{components:["DateTimePicker"],children:(0,d.jsx)(x.K,{label:"Next Appointment Date",value:w,onChange:e=>{S(e)}})})})})}),(0,d.jsxs)("div",{className:"text-end",children:[(0,d.jsx)("button",{type:"submit",className:"btn btn-primary mt-4",style:{width:"10rem"},children:"Submit"}),(0,d.jsx)("button",{type:"submit",className:"btn btn-danger mt-4 ms-2",style:{width:"10rem"},onClick:()=>(i(!1),void o(!0)),children:"Close"})]})]}),(0,d.jsx)(c.N9,{})]})]})},j=e=>{let{patientSearch:t,getSearchByPatient:s}=e;const[a,n]=(0,l.useState)(!1),[i,o]=(0,l.useState)(!1),[c,r]=(0,l.useState)(""),[h,u]=(0,l.useState)(""),p=e=>{r((t=>t===e?"":e)),u(""),o(!0)},x=e=>{u(e),r(e),n(!0),o(!1)},[j,g]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{function e(){g(window.innerWidth<=768)}return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,d.jsx)("div",{children:j?(0,d.jsx)(d.Fragment,{children:null===t||void 0===t?void 0:t.map((e=>{const{name:t,crn:l,phone:r,age:u,sex:j,diagnosis:g,_id:f,desc:y,nextApointmentDate:b}=e,N=c===f,w=h===f,S=g,D=new Date(b).toLocaleString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,d.jsx)("div",{children:(0,d.jsx)("div",{style:{marginTop:"2rem"},children:(0,d.jsx)("div",{className:"card",style:{width:"100%"},children:(0,d.jsxs)("div",{className:"card-body overflow-auto ",children:[(0,d.jsxs)("div",{className:"row",style:{marginBottom:"1rem"},children:[(0,d.jsxs)("div",{style:{width:"40%"},children:[(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"CR No :"})," ",l]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Age : "})," ",u]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Sex. "})," ",j]})]}),(0,d.jsxs)("div",{style:{width:"60%"},children:[(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Name : "})," ",t]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Mob. No."})," ",r]}),(0,d.jsx)("br",{}),(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{className:"boldFont",children:"Next Appointment Date."})," ",b?D:"-"]})]})]}),(0,d.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,d.jsx)("button",{type:"button",className:"btn btn-success patientInfoButton",onClick:()=>p(f),children:"Show Diagnosis"}),(0,d.jsx)("button",{type:"button",className:"btn btn-warning",style:{marginLeft:"2rem"},onClick:()=>x(f),children:g?"Add New Follow-Up":"Add New Diagnosis"})]}),N&&i&&(0,d.jsx)("div",{children:(0,d.jsx)(m,{diagnosis:g,desc:y})}),w&&a&&(0,d.jsx)("div",{children:(0,d.jsx)(v,{_id:f,getSearchByPatient:s,setIsAddNewDiagnosis:n,setIsDetailed:o,diagnosisProp:S})})]})})})},f)}))}):(0,d.jsx)(d.Fragment,{children:null===t||void 0===t?void 0:t.map((e=>{const{name:t,crn:l,phone:r,age:u,sex:j,diagnosis:g,_id:f,desc:y,nextApointmentDate:b}=e,N=c===f,w=h===f,S=g,D=new Date(b).toLocaleString("en-IN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).replace(/\//g,"/");return(0,d.jsx)("div",{className:"row",children:(0,d.jsx)("div",{style:{marginTop:"2rem"},children:(0,d.jsx)("div",{className:"card",style:{width:"100%"},children:(0,d.jsxs)("div",{className:"card-body overflow-auto ",children:[(0,d.jsxs)("h5",{className:"card-title",children:[" CR No : ",l]}),(0,d.jsx)("h6",{className:"card-subtitle mt-2",children:(0,d.jsxs)("h5",{children:["Name : ",t]})}),(0,d.jsxs)("div",{style:{display:"flex",marginTop:"1rem"},children:[(0,d.jsxs)("span",{style:{display:"flex"},children:[(0,d.jsx)("h6",{children:"Phone No. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:r})]}),(0,d.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,d.jsx)("h6",{children:"Age. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:u})]}),(0,d.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,d.jsx)("h6",{children:" Sex. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:j})]}),(0,d.jsxs)("span",{style:{display:"flex",marginLeft:"2rem"},children:[(0,d.jsx)("h6",{children:"Next Appointment Date. \xa0"})," ",(0,d.jsx)("h6",{style:{fontWeight:"normal"},children:b?D:"-"})]})]}),(0,d.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,d.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>p(f),style:{fontSize:"15px",whiteSpace:"none",padding:"5px 10px"},children:"Show Diagnosis"}),(0,d.jsx)("button",{type:"button",className:"btn btn-warning",style:{marginLeft:"2rem"},onClick:()=>x(f),children:g?"Add New Follow-Up":"Add New Diagnosis"})]}),N&&i&&(0,d.jsx)("div",{children:(0,d.jsx)(m,{diagnosis:g,desc:y})}),w&&a&&(0,d.jsx)("div",{children:(0,d.jsx)(v,{_id:f,getSearchByPatient:s,setIsAddNewDiagnosis:n,setIsDetailed:o,diagnosisProp:S})})]})})})},f)}))})})};s(83910);var g=s(63483),f=s(81637),y=s(96446);const b=()=>(0,d.jsx)(y.A,{style:{width:"100%",height:"100%",lineHeight:"20vh",textAlign:"center",marginTop:"10px"},children:(0,d.jsx)(f.A,{})});var N=s(73216);const w=()=>{var e;const t=(0,N.zy)();let s="http://18.204.141.1:8090",n=localStorage.getItem("patientRecord"),i=JSON.parse(n);const[o,m]=(0,l.useState)(!1),[v,f]=(0,l.useState)(!1),[y,w]=(0,l.useState)(!1),[S,D]=l.useState(null),[C,P]=(0,l.useState)(!1),[A,R]=(0,l.useState)(""),[I,F]=(0,l.useState)([]),[E,T]=(0,l.useState)([]),[_,k]=(0,l.useState)([]),[B,L]=(0,l.useState)([]),[W,O]=(0,l.useState)("");let[z,M]=(0,l.useState)(!1);const[U,J]=(0,l.useState)(""),[V,G]=(0,l.useState)({name:"",age:"",sex:"male",phone:"",crn:"",diagnosis:[],desc:"",doctor_id:null===i||void 0===i?void 0:i._id});(0,l.useEffect)((()=>{R(""),H();const e=new URLSearchParams(t.search).get("crn");e&&O(e)}),[]),(0,l.useEffect)((()=>{K()}),[W]);const H=async()=>{try{var e,t;const l=await(0,a.J4)("".concat(s,"/api/problem/").concat(null===i||void 0===i||null===(e=i.department_id)||void 0===e?void 0:e._id)),n=null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.data[0];if(n){const e=n.problemName.filter((e=>"problem"===e.type)).map((e=>e.name)),t=n.problemName.filter((e=>"scale"===e.type)).map((e=>e.name)),s=n.problemName.filter((e=>"test"===e.type)).map((e=>{let{name:t,inputType:s}=e;return{name:t,inputType:s}}));k(s),L(t),T(e)}}catch(l){console.error("Error fetching problems:",l)}},K=async()=>{try{var e,l;let n=A||(null===t||void 0===t||null===(e=t.state)||void 0===e?void 0:e.crn)||W;if(0===(null===n||void 0===n?void 0:n.length))return;f(!0);const i=await(0,a.J4)("".concat(s,"/api/patient/").concat(n));F(null===i||void 0===i||null===(l=i.data)||void 0===l?void 0:l.data),setTimeout((()=>{f(!1)}),3e3)}catch(n){console.log(n)}};(0,l.useEffect)((()=>{}));(0,l.useEffect)((()=>{!0===o&&K()}),[o]);let[$,q]=(0,l.useState)(new Date);(0,l.useEffect)((()=>{var e,s;null!==t&&void 0!==t&&null!==(e=t.state)&&void 0!==e&&e.crn&&(R(null===t||void 0===t||null===(s=t.state)||void 0===s?void 0:s.crn),K())}),[t]);let[Y,X]=(0,l.useState)(!1);const[Q,Z]=(0,l.useState)([{problem:"",test:"",testInput:"",files:[],scale:"",value:""}]),ee=(e,t)=>{const{name:s,value:l}=t.target,a=[...Q];a[e][s]=l,Z(a)},te=()=>{Q.every((e=>""!==e.problem))?Z([...Q,{problem:"",test:"",testInput:"",files:[],scale:"",value:""}]):c.oR.warning("Please Fill Details of previous Record before adding new!!",{autoClose:1500})},se=e=>{const t=[...Q];t.splice(e,1),Z(t)};(0,l.useEffect)((()=>{Q.length>1?X(!0):X(!1)}),[se,te,ee]),(0,l.useEffect)((()=>{console.log("Updated inputs:",Q)}),[Q]);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{children:[C||y?"":(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{style:{fontWeight:"bolder"},children:"Search Patient"}),(0,d.jsxs)("div",{className:"search-container",children:[(0,d.jsxs)("div",{className:"search-input",children:[(0,d.jsx)("input",{style:{paddingLeft:"5px"},className:"form-control",placeholder:"CR no. or Phone no.",type:"text",name:"search",value:A,onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),K())},onChange:e=>R(e.target.value)}),(0,d.jsx)("button",{className:"btn btn-primary searchButton",type:"button",onClick:K,children:"Search"}),null!==A&&void 0!==A&&A.length?(0,d.jsx)("button",{className:"btn btn-danger text-light clearButton",type:"button",onClick:()=>{try{R(""),F([])}catch(e){console.log(e)}},children:"Clear"}):null]}),(0,d.jsx)("div",{className:"add-patient-btn",children:(0,d.jsx)("button",{type:"button",onClick:()=>P(!0),className:"btn btn-outline-dark",children:"Add a Patient"})})]})]}),null===I||void 0===I||!I.length||C||y?(0,d.jsx)("div",{children:C?(0,d.jsxs)(d.Fragment,{children:[z&&(0,d.jsx)(r.A,{loading:z}),(0,d.jsx)("div",{className:"content-to-be-blurred",children:(0,d.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("hr",{}),(0,d.jsx)("h4",{children:"Patient Details"}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"row",children:[(0,d.jsx)("div",{className:"col-md-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Name ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsx)("input",{type:"text",className:"form-control ",name:"name",value:V.name,onChange:e=>G({...V,name:e.target.value})})})]})}),(0,d.jsx)("div",{className:"col-md-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Age ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsx)("input",{type:"number",className:"form-control ",name:"age",value:V.age,onChange:e=>G({...V,age:e.target.value})})})]})}),(0,d.jsx)("div",{className:"col-md-4",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4 mt-2 patientNamediv",children:["Sex ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsxs)("select",{className:"form-control ",name:"sex",value:V.sex,onChange:e=>G({...V,sex:e.target.value}),children:[(0,d.jsx)("option",{value:"male",children:"Male"}),(0,d.jsx)("option",{value:"female",children:"Female"}),(0,d.jsx)("option",{value:"other",children:"Other"})]})})]})})]}),(0,d.jsxs)("div",{className:"row ",children:[(0,d.jsx)("div",{className:"col-md-4 mt-2",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-lg-4 patientNamediv",children:["Phone No ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:" col-lg-8 col-sm-8",children:(0,d.jsx)("input",{className:"form-control ",type:"text",name:"phone",value:V.phone,onChange:e=>{(/^\d*$/.test(e.target.value)||""===e.target.value)&&G({...V,phone:e.target.value})},required:!0})})]})}),(0,d.jsx)("div",{className:"col-md-4 mt-2",children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"col-sm-4  patientNamediv",children:["CR No ",(0,d.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,d.jsx)("div",{className:"col-sm-8",children:(0,d.jsx)("input",{className:"form-control ",type:"test",name:"crn",value:V.crn,onChange:e=>G({...V,crn:e.target.value}),required:!0})})]})})]})]}),(0,d.jsx)("hr",{}),(0,d.jsx)("div",{className:"addPatientDataInnerDiv",children:(0,d.jsxs)("h4",{children:["Diagnosis: (",null===i||void 0===i||null===(e=i.department_id)||void 0===e?void 0:e.departmentName,")"]})}),(0,d.jsx)("div",{children:(0,d.jsxs)("form",{className:"mb-3",children:[Q.map(((e,t)=>(0,d.jsxs)("div",{className:"row mt-1 mb-2",children:[(0,d.jsx)("div",{className:"col-md-2 col-12",children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"problem",value:e.problem,onChange:e=>ee(t,e),children:[(0,d.jsx)("option",{value:"",children:"Chief complaint"}),E.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})})}),(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"test",value:e.test,onChange:e=>ee(t,e),children:[(0,d.jsx)("option",{value:"",children:"Select Test"}),_.map(((e,t)=>(0,d.jsx)("option",{value:e.name,children:e.name},t)))]})})}),""===e.test?(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Select a Test",type:"text",disabled:"true"})})}):(0,d.jsx)("div",{className:"col-md-2 col-6",children:_.map(((s,l)=>{if(s.name===e.test){if("text"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},placeholder:"Enter test Value",type:"text",name:"testInput",value:e.testInput.text,onChange:e=>((e,t)=>{const{name:s,value:l}=t.target,a=[...Q];a[e][s]=l,Z(a)})(t,e)})},l);if("file"===s.inputType)return(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control",style:{width:"100%"},type:"file",multiple:!0,name:"files",accept:"image/jpeg, image/png, application/pdf",onChange:e=>((e,t)=>{const{name:s,files:l}=t.target,a=["image/jpeg","image/png","application/pdf"];if(l.length>3)return t.target.value="",void c.oR.warning("You can only upload up to 3 files",{autoClose:1500});const n=[...Q],i=Array.from(l).filter((e=>e.size>31457280?(c.oR.warning("File size should be less than 30 MB",{autoClose:1500}),!1):!!a.includes(e.type)||(c.oR.warning("Only images and PDFs are allowed",{autoClose:1500}),!1)));n[e][s]=i,Z(n)})(t,e)})},l)}return null}))}),(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsxs)("select",{className:"form-control addPatientDataSelectDiv",name:"scale",value:e.scale,onChange:e=>ee(t,e),children:[(0,d.jsx)("option",{value:"",children:"Select Scale"}),B.map(((e,t)=>(0,d.jsx)("option",{value:e,children:e},t)))]})})}),(0,d.jsx)("div",{className:"col-md-2 col-6",children:(0,d.jsx)("label",{children:(0,d.jsx)("input",{className:"form-control addPatientDataInputDiv",placeholder:"Enter Scale Value",type:"text",name:"value",value:e.value,onChange:e=>ee(t,e)})})}),(0,d.jsx)("div",{className:"col-md-2 d-flex justify-content-end col-12",children:Y&&(0,d.jsx)("button",{className:"btn btn-danger me-4 mt-1",type:"button",onClick:()=>se(t),children:"Remove"})})]},t))),(0,d.jsx)("div",{className:"d-flex justify-content-end",children:(0,d.jsx)("button",{className:"btn btn-primary me-4",type:"button",onClick:te,children:"Add More"})})]})}),(0,d.jsx)("div",{children:(0,d.jsx)("textarea",{rows:4,className:"form-control col-12",placeholder:"Notes (Optional)",name:"desc",value:U,onChange:e=>J(e.target.value)})})]}),(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"d-flex mt-2",children:(0,d.jsx)("div",{className:"w-auto",children:(0,d.jsx)(p.$,{dateAdapter:u.R,children:(0,d.jsx)(h.j,{components:["DateTimePicker"],children:(0,d.jsx)(x.K,{label:"Next Appointment Date",value:S,onChange:e=>{D(e)}})})})})})}),(0,d.jsxs)("div",{className:"text-end m-4",children:[(0,d.jsx)("button",{className:"btn btn-info mt-3 mx-2 w-auto",onClick:async()=>{if(R(""),!V.name||!V.age||!V.sex||!V.phone||!V.crn)return c.oR.warning("Please fill all Patient details");if(1===Q.length&&""===Q[0].problem)return c.oR.warning("Please select at least one Chief complaint");const e=Q.filter((e=>""!==e.problem));for(const s of e){if(""!==s.test&&""===s.testInput&&0===s.files.length)return void c.oR.warning("Please give input for selected test");if(""!==s.scale&&""===s.value)return void c.oR.warning("Please give input for selected scale");console.log("data",s)}M(!0);try{await Promise.all(e.map((async(t,l)=>{if(t.files){const n=t.files;if(n.length>0){const t=new FormData;if(n.forEach((e=>{["image/jpeg","image/png","application/pdf"].includes(e.type)?t.append("files",e):console.warn("File type not allowed:",e.type)})),t.has("files")){const n=await(0,a.De)("".concat(s,"/api/user/uploadPatientReport"),t);n&&(M(!1),e[l].files=n.filesInfo)}else M(!1),console.warn("No valid files to upload")}}else e[l].files=null,M(!1)})))}catch(o){return M(!1),void console.error("Error uploading files:",o)}const t={...V,diagnosis:[{diagnosData:e,date:Date(),desc:U}],nextApointmentDate:S};try{var l,n;const e=await localStorage.getItem("patientRecord"),o=null===(l=JSON.parse(e))||void 0===l?void 0:l._id,r=await(0,a.Hl)("".concat(s,"/api/patient/create/").concat(o),t);!0===r.success&&(c.oR.success("Patient Created Successfully",{autoClose:2e3}),M(!1),w(!0),P(!1),m(!0),w(!1),J(""),D(null),Z([{problem:"",test:"",testInput:"",files:[],scale:"",value:""}]),G({name:"",age:"",sex:"male",phone:"",crn:"",diagnosis:[],desc:"",doctor_id:null===i||void 0===i?void 0:i._id})),"phone Already Exists"===r.message&&(c.oR.warning("phone Already Exists"),M(!1)),"Crn Already Exists"===r.message&&(c.oR.warning("Crn Already Exists"),M(!1)),R(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.crn)}catch(o){c.oR.warning("Something went wrong"),M(!1),console.error("Error submitting data:",o)}},children:"Submit"}),(0,d.jsx)("button",{className:"btn btn-info mt-3 w-auto",onClick:()=>{P(!1),Z([{problem:"",test:"",testInput:"",files:[],scale:"",value:""}]),G({name:"",age:"",sex:"male",phone:"",crn:"",diagnosis:[],desc:"",doctor_id:null===i||void 0===i?void 0:i._id})},children:"Close"})]})]})})]}):(0,d.jsx)("div",{children:y?"":(0,d.jsx)("div",{className:"loaderDivInPatientPage",children:v?(0,d.jsx)(g.A,{}):"No Data"})})}):(0,d.jsx)(j,{patientSearch:I,setData:P,getSearchByPatient:K})]}),y?(0,d.jsx)(b,{}):"",(0,d.jsx)(c.N9,{})]})}}}]);
//# sourceMappingURL=4349.c64a2c6f.chunk.js.map